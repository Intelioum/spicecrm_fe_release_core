/*
SpiceUI 1.1.0

This file is part of SpiceCRM in its "More" Editions and thus is licensed and copyrighted software. Your installation or use of this SpiceCRM file is subject to the license agreement you entered regaridng the use of SpiceCRM with aac services k.s or any of its affiliates and partners.

If you are unsure about your licese agreement please contat aac services k.s. at office@all-about-crm.com

Copyright (c) 2016-present, aac services.k.s - All rights reserved.
*/

"use strict";var __decorate=this&&this.__decorate||function(e,s,t,o){var i,a=arguments.length,l=a<3?s:null===o?o=Object.getOwnPropertyDescriptor(s,t):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,s,t,o);else for(var n=e.length-1;0<=n;n--)(i=e[n])&&(l=(a<3?i(l):3<a?i(s,t,l):i(s,t))||l);return 3<a&&l&&Object.defineProperty(s,t,l),l},__metadata=this&&this.__metadata||function(e,s){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,s)};Object.defineProperty(exports,"__esModule",{value:!0});var common_1=require("@angular/common"),forms_1=require("@angular/forms"),core_1=require("@angular/core"),http_1=require("@angular/common/http"),router_1=require("@angular/router"),platform_browser_1=require("@angular/platform-browser"),services_1=require("../services/services"),services_2=require("../services/services"),services_3=require("../services/services"),services_4=require("../services/services"),services_5=require("../services/services"),services_6=require("../services/services"),services_7=require("../services/services"),services_8=require("../services/services"),services_9=require("../services/services"),services_10=require("../services/services"),services_11=require("../services/services"),services_12=require("../services/services"),services_13=require("../services/services"),services_14=require("../services/services"),services_15=require("../services/services"),services_16=require("../services/services"),services_17=require("../services/services"),services_18=require("../services/services"),objectfields_1=require("../objectfields/objectfields"),systemcomponents_1=require("../systemcomponents/systemcomponents"),MenuService=function(){function e(e,s){this.http=e,this.configurationService=s,this.menuitems=[]}return e.prototype.loadModules=function(){new http_1.HttpHeaders},e=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[http_1.HttpClient,services_4.configurationService])],e)}();exports.MenuService=MenuService;var GlobalHeader=function(){function e(e,s,t){var o=this;this.session=e,this.router=s,this.toast=t,this.router.events.subscribe(function(e){e instanceof router_1.ActivationStart&&"Users"===e.snapshot.params.module&&e.snapshot.params.id&&(o.session.authData.admin||e.snapshot.params.id==o.session.authData.userId||(o.toast.sendToast("You are not allowed to view or edit foreign user data.","warning",null,3),o.router.navigate(["/module/Users"])))})}return e=__decorate([core_1.Component({selector:"global-header",template:'<header *ngIf="session.authData.sessionId && session.authData.loaded === true" class="slds-global-header_container"><global-header-top></global-header-top><global-navigation></global-navigation></header>',providers:[]}),__metadata("design:paramtypes",[services_2.session,router_1.Router,services_15.toast])],e)}();exports.GlobalHeader=GlobalHeader;var GlobalHeaderTop=function(){function e(e){this.metadata=e}return Object.defineProperty(e.prototype,"showSearch",{get:function(){return this.metadata.getActiveRole().showsearch&&"0"!=this.metadata.getActiveRole().showsearch},enumerable:!0,configurable:!0}),e=__decorate([core_1.Component({selector:"global-header-top",template:'<a href="javascript:void(0);" class="slds-assistive-text slds-assistive-text--focus">Skip to Navigation</a><a href="javascript:void(0);" class="slds-assistive-text slds-assistive-text--focus">Skip to Main Content</a><div class="slds-global-header slds-grid slds-grid--align-spread"><div class="slds-global-header__item slds-size--1-of-3"><div><img style="max-height: 25px;" src="./config/headerimage"></div></div><div class="slds-size--1-of-3"><global-header-search *ngIf="showSearch"></global-header-search></div><div class="slds-grid slds-global-header__item slds-grid--align-end slds-grid--vertical-align-center slds-size--1-of-3"><global-header-tools></global-header-tools><global-user></global-user></div></div>'}),__metadata("design:paramtypes",[services_11.metadata])],e)}();exports.GlobalHeaderTop=GlobalHeaderTop;var GlobalHeaderSearch=function(){function e(e,s,t,o,i,a,l){var n=this;this.router=e,this.broadcast=s,this.fts=t,this.elementRef=o,this.renderer=i,this.popup=a,this.language=l,this.showRecent=!1,this.searchTimeOut=void 0,this.searchTerm="",this.searchTermUntrimmed="",a.closePopup$.subscribe(function(e){n.closePopup()})}return e.prototype.onFocus=function(){var s=this;this.showRecent=!0,this.clickListener=this.renderer.listenGlobal("document","click",function(e){return s.onClick(e)})},e.prototype.closePopup=function(){this.clickListener(),this.showRecent=!1,this.searchTerm="",this.searchTermUntrimmed=""},e.prototype.doSearch=function(){this.searchTerm=this.searchTermUntrimmed.trim(),this.searchTerm.length&&this.searchTerm!==this.fts.searchTerm&&(this.fts.search(this.searchTerm),this.broadcast.broadcastMessage("fts.search",this.searchTerm))},e.prototype.clearSearchTerm=function(){this.searchTimeOut&&window.clearTimeout(this.searchTimeOut),this.searchTerm="",this.searchTermUntrimmed="",this.fts.searchTerm=""},e.prototype.search=function(e){var s=this;switch(this.showRecent=!0,e.key){case"ArrowDown":case"ArrowUp":break;case"Enter":this.searchTerm=this.searchTermUntrimmed.trim(),this.searchTerm.length&&(this.searchTimeOut&&window.clearTimeout(this.searchTimeOut),this.fts.searchTerm=this.searchTerm,this.broadcast.broadcastMessage("fts.search",this.searchTerm),this.router.navigate(["/search"]),this.popup.close());break;default:this.searchTimeOut&&window.clearTimeout(this.searchTimeOut),this.searchTimeOut=window.setTimeout(function(){return s.doSearch()},1e3)}},e.prototype.onClick=function(e){this.elementRef.nativeElement.contains(e.target)||this.closePopup()},e=__decorate([core_1.Component({selector:"global-header-search",template:'<div class="slds-global-header__item slds-global-header__item--search"><div class="slds-form-element slds-lookup"><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--left-right"><system-utility-icon [icon]="\'search\'" [addclasses]="\'slds-input__icon slds-input__icon--left\'"></system-utility-icon><input class="slds-input slds-lookup__search-input" type="search" [placeholder]="language.getLabel(\'LBL_SEARCH_SPICE\')" (focus)="onFocus()" [(ngModel)]="searchTermUntrimmed" (keyup)="search($event)"> <button *ngIf="searchTerm.length > 0" class="slds-input__icon slds-input__icon--right slds-button slds-button--icon" (click)="clearSearchTerm()"><system-button-icon [icon]="\'close\'"></system-button-icon></button></div><global-header-search-recent-items *ngIf="showRecent && searchTerm === \'\'"></global-header-search-recent-items><global-header-search-results-items *ngIf="showRecent && searchTerm !== \'\'" [searchTerm]="searchTerm"></global-header-search-results-items></div></div>',providers:[services_5.popup],host:{}}),__metadata("design:paramtypes",[router_1.Router,services_6.broadcast,services_7.fts,core_1.ElementRef,core_1.Renderer,services_5.popup,services_3.language])],e)}();exports.GlobalHeaderSearch=GlobalHeaderSearch;var GlobalHeaderSearchResultsItems=function(){function e(e,s,t,o,i){this.broadcast=e,this.fts=s,this.popup=t,this.router=o,this.language=i,this.searchTerm=""}return e.prototype.goSearch=function(){this.fts.searchTerm=this.searchTerm,this.broadcast.broadcastMessage("fts.search",this.searchTerm),this.router.navigate(["/search"]),this.popup.close()},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"searchTerm",void 0),e=__decorate([core_1.Component({selector:"global-header-search-results-items",template:'<div class="slds-lookup__menu" style="display:block"><ul class="slds-lookup__list" role="listbox"><li role="presentation" (click)="goSearch()"><span class="slds-lookup__item-action slds-media slds-media--center" role="option"><system-icon icon="search" size="small" sprite="utility"></system-icon><div class="slds-media__body"><div class="slds-lookup__result-text">{{language.getLabel(\'LBL_SEARCH\')}} "{{searchTerm}}" {{language.getLabel(\'LBL_INSPICECRM\')}}</div></div></span></li><li global-header-search-results-item *ngFor="let hit of fts.hits" [hit]="hit"></li></ul></div>'}),__metadata("design:paramtypes",[services_6.broadcast,services_7.fts,services_5.popup,router_1.Router,services_3.language])],e)}();exports.GlobalHeaderSearchResultsItems=GlobalHeaderSearchResultsItems;var GlobalHeaderSearchResultsItem=function(){function e(e,s,t,o){this.model=e,this.router=s,this.popup=t,this.language=o,this.hit={}}return e.prototype.navigateTo=function(){this.router.navigate(["/module/"+this.model.module+"/"+this.model.id]),this.popup.close()},e.prototype.gethref=function(){return"#/module/"+this.model.module+"/"+this.model.id},e.prototype.ngOnInit=function(){for(var e in this.model.module=this.hit._type,this.model.id=this.hit._id,this.hit._source)this.model.data[e]=this.hit._source[e]},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"hit",void 0),e=__decorate([core_1.Component({selector:"[global-header-search-results-item]",template:'<span class="slds-lookup__item-action slds-media slds-media--center" role="option"><system-icon [module]="model.module" size="small"></system-icon><div class="slds-media__body"><div class="slds-lookup__result-text">{{model.data.summary_text}}</div><span class="slds-lookup__result-meta slds-text-body--small">{{language.getModuleName(model.module, true)}}</span></div></span>',providers:[services_8.model],host:{"(click)":"navigateTo()"}}),__metadata("design:paramtypes",[services_8.model,router_1.Router,services_5.popup,services_3.language])],e)}();exports.GlobalHeaderSearchResultsItem=GlobalHeaderSearchResultsItem;var GlobalHeaderSearchRecentItems=function(){function e(e,s,t,o){this.language=e,this.recent=s,this.popup=t,this.router=o}return e.prototype.goRecent=function(){this.router.navigate(["/recent"]),this.popup.close()},e=__decorate([core_1.Component({selector:"global-header-search-recent-items",template:'<div class="slds-lookup__menu" style="display:block"><ul class="slds-lookup__list" role="listbox"><li role="presentation" (click)="goRecent()"><span class="slds-lookup__item-action slds-media slds-media--center" role="option"><system-icon icon="breadcrumbs" size="small" sprite="utility"></system-icon><div class="slds-media__body"><div class="slds-lookup__result-text">{{language.getLabel(\'LBL_RECENTLYVIEWED\')}}</div></div></span></li><li global-header-search-recent-item *ngFor="let item of recent.items.slice(0, 5)" [item]="item"></li></ul></div>'}),__metadata("design:paramtypes",[services_3.language,services_9.recent,services_5.popup,router_1.Router])],e)}();exports.GlobalHeaderSearchRecentItems=GlobalHeaderSearchRecentItems;var GlobalHeaderSearchRecentItem=function(){function e(e,s,t,o){this.model=e,this.router=s,this.popup=t,this.language=o,this.item={}}return e.prototype.navigateTo=function(){this.router.navigate(["/module/"+this.model.module+"/"+this.model.id]),this.popup.close()},e.prototype.gethref=function(){return"#/module/"+this.model.module+"/"+this.model.id},e.prototype.ngOnInit=function(){this.model.module=this.item.module_name,this.model.id=this.item.item_id,this.model.data.summary_text=this.item.item_summary},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"item",void 0),e=__decorate([core_1.Component({selector:"[global-header-search-recent-item]",template:'<span class="slds-lookup__item-action slds-media slds-media--center" role="option"><system-icon [module]="model.module" size="small"></system-icon><div class="slds-media__body"><div class="slds-lookup__result-text">{{model.data.summary_text}}</div><span class="slds-lookup__result-meta slds-text-body--small">{{language.getModuleName(model.module, true)}}</span></div></span>',providers:[services_8.model],host:{"(click)":"navigateTo()"}}),__metadata("design:paramtypes",[services_8.model,router_1.Router,services_5.popup,services_3.language])],e)}();exports.GlobalHeaderSearchRecentItem=GlobalHeaderSearchRecentItem;var GlobalHeaderTools=function(){function e(e,s,t,o){this.session=e,this.metadata=s,this.router=t,this.language=o}return e.prototype.ngAfterViewInit=function(){var e=this.metadata.getComponentConfig("GlobalHeaderTools");if(!e.componentset)return!1;for(var s=0,t=this.metadata.getComponentSetObjects(e.componentset);s<t.length;s++){var o=t[s];this.metadata.addComponent(o.component,this.toolcontainer)}},__decorate([core_1.ViewChild("toolcontainer",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"toolcontainer",void 0),e=__decorate([core_1.Component({selector:"global-header-tools",template:'<div class="slds-grid slds-grid--vertical-align-center"><div #toolcontainer></div></div>'}),__metadata("design:paramtypes",[services_2.session,services_11.metadata,router_1.Router,services_3.language])],e)}();exports.GlobalHeaderTools=GlobalHeaderTools;var GlobalHeaderActions=function(){function GlobalHeaderActions(e,s,t,o,i){this.renderer=e,this.elementRef=s,this.session=t,this.metadata=o,this.language=i,this.isOpen=!1}return GlobalHeaderActions.prototype.toggleOpen=function(){var s=this;this.isOpen=!this.isOpen,this.isOpen?this.clickListener=this.renderer.listen("document","click",function(e){return s.onClick(e)}):this.clickListener&&this.clickListener()},GlobalHeaderActions.prototype.onClick=function(e){this.elementRef.nativeElement.contains(e.target)||(this.isOpen=!1,this.clickListener())},Object.defineProperty(GlobalHeaderActions.prototype,"hostClass",{get:function(){return"slds-dropdown-trigger slds-dropdown-trigger_click slds-p-horizontal_xxx-small"+(this.isOpen?" slds-is-open":"")},enumerable:!0,configurable:!0}),GlobalHeaderActions.prototype.ngAfterViewInit=function(){var t=this,e=this.metadata.getComponentConfig("GlobalHeaderActions");if(e&&e.actionset)for(var s=this.metadata.getActionSetItems(e.actionset),o=function(s){i.metadata.addComponent(s.component,i.actioncontainerheader).subscribe(function(e){e.instance.actionconfig=s.actionconfig,e.instance.closemenu&&e.instance.closemenu.subscribe(function(e){t.isOpen=!1})})},i=this,a=0,l=s;a<l.length;a++){o(l[a])}},__decorate([core_1.ViewChild("actioncontainerheader",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],GlobalHeaderActions.prototype,"actioncontainerheader",void 0),GlobalHeaderActions=__decorate([core_1.Component({selector:"global-header-actions",template:'<div class="slds-dropdown-trigger slds-dropdown-trigger_click slds-p-horizontal--xxx-small" [ngClass]="{\'slds-is-open\': isOpen}"><button class="slds-button slds-global-header__button--icon slds-p-vertical--xxx-small" (click)="toggleOpen()"><system-utility-icon [icon]="\'add\'" [size]="\'x-small\'"></system-utility-icon></button><div class="slds-is-absolute slds-dropdown slds-dropdown_right slds-nubbin_top-right" style="right:-10px;top:25px;"><ul class="slds-dropdown__list" role="menu"><li #actioncontainerheader class="slds-dropdown__header" role="separator"><span class="slds-text-title_caps">{{language.getLabel(\'LBL_CREATE\')}}</span></li></ul></div></div>'}),__metadata("design:paramtypes",[core_1.Renderer2,core_1.ElementRef,services_2.session,services_11.metadata,services_3.language])],GlobalHeaderActions)}();exports.GlobalHeaderActions=GlobalHeaderActions;var GlobalHeaderActionItem=function(){function GlobalHeaderActionItem(e,s,t,o,i){this.session=e,this.metadata=s,this.model=t,this.language=o,this.dockedComposer=i,this.actionconfig={},this.closemenu=new core_1.EventEmitter}return GlobalHeaderActionItem.prototype.ngOnInit=function(){this.actionconfig.module&&(this.model.module=this.actionconfig.module)},GlobalHeaderActionItem.prototype.click=function(){this.dockedComposer.addComposer(this.model.module),this.closemenu.emit(!0)},Object.defineProperty(GlobalHeaderActionItem.prototype,"label",{get:function(){return this.actionconfig.label?this.language.getLabel(this.actionconfig.label):this.language.getModuleLabel(this.model.module,"LBL_NEW_FORM_TITLE")},enumerable:!0,configurable:!0}),GlobalHeaderActionItem=__decorate([core_1.Component({selector:"global-header-action-item",template:'<li class="slds-dropdown__item" role="presentation"><a href="javascript:void(0)" (click)="click()" class="slds-grid slds-grid_vertical-align-center slds-p-horizontal--x-small slds-p-vertical--xx-small"><system-icon [module]="model.module" [addclasses]="\'slds-icon slds-icon_small slds-icon-standard-event\'"></system-icon><div class="slds-truncate slds-size--1-of-1">{{label}}</div></a></li>',providers:[services_8.model]}),__metadata("design:paramtypes",[services_2.session,services_11.metadata,services_8.model,services_3.language,services_13.dockedComposer])],GlobalHeaderActionItem)}();exports.GlobalHeaderActionItem=GlobalHeaderActionItem;var GlobalHeaderFavorite=function(){function GlobalHeaderFavorite(e,s,t,o,i,a,l){var n=this;this.metadata=e,this.favorite=s,this.router=t,this.popup=o,this.renderer=i,this.elementRef=a,this.language=l,this.showFavorites=!1,this.router.events.subscribe(function(e){"NavigationStart"==e.constructor.name&&n.favorite.disable()}),o.closePopup$.subscribe(function(e){n.showFavorites=!1,n.clickListener&&n.clickListener()})}return Object.defineProperty(GlobalHeaderFavorite.prototype,"canShowFavorites",{get:function(){return this.metadata.getActiveRole().showfavorites&&"0"!=this.metadata.getActiveRole().showfavorites},enumerable:!0,configurable:!0}),Object.defineProperty(GlobalHeaderFavorite.prototype,"nofavorites",{get:function(){return 0==this.favorite.favorites.length},enumerable:!0,configurable:!0}),GlobalHeaderFavorite.prototype.isDisabled=function(){return!this.favorite.isEnabled},Object.defineProperty(GlobalHeaderFavorite.prototype,"isfavorite",{get:function(){return this.favorite.isFavorite},enumerable:!0,configurable:!0}),GlobalHeaderFavorite.prototype.getFavoriteActive=function(){return this.favorite.isFavorite?"spicecrm-favorite--active":"spicecrm-favorite--inactive"},GlobalHeaderFavorite.prototype.toggleFavorite=function(){this.favorite.isFavorite?this.favorite.deleteFavorite():this.favorite.setFavorite()},GlobalHeaderFavorite.prototype.toggleFavorites=function(){var s=this;this.showFavorites=!this.showFavorites,this.showFavorites?this.clickListener=this.renderer.listen("document","click",function(e){return s.onClick(e)}):this.clickListener&&this.clickListener()},GlobalHeaderFavorite.prototype.onClick=function(e){this.elementRef.nativeElement.contains(e.target)||(this.showFavorites=!1,this.clickListener())},GlobalHeaderFavorite=__decorate([core_1.Component({selector:"global-header-favorite",template:'<div *ngIf="canShowFavorites" class="slds-dropdown-trigger slds-dropdown-trigger--click slds-is-open"><div class="slds-button-group"><button class="slds-button slds-button--neutral slds-p-horizontal--xx-small slds-p-vertical--xx-small-small" [ngClass]="getFavoriteActive()" [disabled]="isDisabled()" (click)="toggleFavorite()"><system-utility-icon icon="favorite" size="x-small"></system-utility-icon></button> <button class="slds-button slds-button--neutral slds-p-horizontal--xx-small slds-p-vertical--xx-small" [disabled]="nofavorites" (click)="toggleFavorites()"><system-button-icon icon="down" size="xx-small"></system-button-icon></button></div><div *ngIf="showFavorites" class="slds-dropdown slds-dropdown--right slds-dropdown--medium"><ul class="slds-dropdown__list" role="menu"><li class="slds-dropdown__header" role="separator"><span class="slds-text-title--caps">{{language.getLabel(\'LBL_FAVORITES\')}}</span></li><li global-header-search-recent-item class="slds-dropdown__item" role="presentation" *ngFor="let item of favorite.favorites" [item]="item"></li></ul></div></div>',providers:[services_5.popup],styles:[":host >>> .spicecrm-favorite--inactive svg {fill: transparent; stroke: grey;}",":host >>> .slds-button.spicecrm-favorite--inactive:focus  svg {fill: transparent; stroke: grey;}",":host >>> .slds-button.spicecrm-favorite--inactive:not(:disabled):hover svg {fill: transparent; stroke: #CA1B21;}"]}),__metadata("design:paramtypes",[services_11.metadata,services_10.favorite,router_1.Router,services_5.popup,core_1.Renderer2,core_1.ElementRef,services_3.language])],GlobalHeaderFavorite)}();exports.GlobalHeaderFavorite=GlobalHeaderFavorite;var GlobalHeaderWorkbench=function(){function GlobalHeaderWorkbench(e,s,t){this.session=e,this.router=s,this.language=t}return GlobalHeaderWorkbench.prototype.isAdmin=function(){return this.session.isAdmin},GlobalHeaderWorkbench.prototype.goAdmin=function(){this.router.navigate(["/admin"])},GlobalHeaderWorkbench=__decorate([core_1.Component({selector:"global-header-workbench",template:'<button *ngIf="isAdmin()" class="slds-button slds-global-header__button--icon slds-p-vertical--xxx-small" [title]="language.getLabel(\'LBL_WORKBENCH\')" (click)="goAdmin()"><system-utility-icon [icon]="\'setup\'" [size]="\'x-small\'"></system-utility-icon></button>'}),__metadata("design:paramtypes",[services_2.session,router_1.Router,services_3.language])],GlobalHeaderWorkbench)}();exports.GlobalHeaderWorkbench=GlobalHeaderWorkbench;var GlobalFooter=function(){function e(e,s,t){this.session=e,this.footer=s,this.modalservice=t}return e.prototype.ngAfterViewInit=function(){this.footer.footercontainer=this.footercontainer,this.footer.modalcontainer=this.modalcontainer,this.footer.modalbackdrop=this.modalbackdrop},__decorate([core_1.ViewChild("footercontainer",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"footercontainer",void 0),__decorate([core_1.ViewChild("modalcontainer",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"modalcontainer",void 0),__decorate([core_1.ViewChild("modalbackdrop",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"modalbackdrop",void 0),e=__decorate([core_1.Component({selector:"global-footer",template:'<footer><div class="slds-docked_container" *ngIf="session.authData.sessionId && session.authData.loaded === true"><global-docked-composer-container></global-docked-composer-container></div><div #footercontainer></div><div data-info="ModalContainer" style="position:fixed;z-index:10000"><div #backdrop class="slds-backdrop" [class.slds-backdrop_open]="modalservice.backdropVisible" [style.zIndex]="modalservice.backdropZindex"></div><span #modalcontainer></span></div><system-toast-container style="position:fixed;z-index:100000"></system-toast-container></footer>'}),__metadata("design:paramtypes",[services_2.session,services_16.footer,services_18.modal])],e)}();exports.GlobalFooter=GlobalFooter;var GlobalLogin=function(){function e(e,s,t,o,i,a,l){var n=this;if(this.loginService=e,this.http=s,this.configuration=t,this.session=o,this.cookie=i,this.language=a,this.sanitizer=l,this.promptUser=!1,this.username="",this.password="",this._selectedlanguage="",this.selectedsite="",this.lastSelectedLanguage=null,this.showForgotPass=!1,this.externalSidebarUrl=null,sessionStorage["OAuth-Token"]&&0<sessionStorage["OAuth-Token"].length){var r=new http_1.HttpHeaders;r=r.set("OAuth-Token",sessionStorage["OAuth-Token"]),sessionStorage[btoa(sessionStorage["OAuth-Token"]+":siteid")]&&this.configuration.setSiteID(atob(sessionStorage[btoa(sessionStorage["OAuth-Token"]+":siteid")])),this.http.get(this.configuration.getBackendUrl()+"/login",{headers:r}).subscribe(function(e){var s=e;n.session.authData.sessionId=s.id,n.session.authData.userId=s.userid,n.session.authData.userName=s.user_name,n.session.authData.first_name=s.first_name,n.session.authData.last_name=s.last_name,n.session.authData.display_name=s.display_name,n.session.authData.email=s.email,n.session.authData.admin=1==s.admin,n.session.authData.renewPass="1"===s.renewPass,n.session.authData.renewPass||n.loginService.load()},function(e){switch(e.status){case 401:n.promptUser=!0}})}else this.promptUser=!0,this.selectedsite=this.cookie.getValue("spiceuibackend"),this.selectedsite&&this.configuration.setSiteID(this.selectedsite);this.lastSelectedLanguage=this.cookie.getValue("spiceuilanguage")}return e.prototype.keypressed=function(e){13!==e.keyCode||this.showForgotPass||this.session.authData.renewPass||this.login()},e.prototype.login=function(){0<this.username.length&&0<this.password.length&&(this.loginService.authData.userName=this.username,this.loginService.authData.password=this.password,this.loginService.login())},Object.defineProperty(e.prototype,"selectedlanguage",{get:function(){return this._selectedlanguage||(this.lastSelectedLanguage?this.selectedlanguage=this.lastSelectedLanguage:this.configuration.data.languages&&(this.selectedlanguage=this.configuration.data.languages.default)),this._selectedlanguage},set:function(e){this._selectedlanguage=e,this.language.currentlanguage=e},enumerable:!0,configurable:!0}),e.prototype.getLanguages=function(){var e=[];if(this.configuration.data.languages)for(var s=0,t=this.configuration.data.languages.available;s<t.length;s++){var o=t[s];e.push({language:o.language_code,text:o.language_name})}return e},e.prototype.doLogin=function(){this.loginService.login()},Object.defineProperty(e.prototype,"currentSiteId",{get:function(){return this.configuration.data.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sites",{get:function(){return this.configuration.sites},enumerable:!0,configurable:!0}),e.prototype.getBackendUrls=function(){return this.configuration.data.backendUrls?this.configuration.data.backendUrls:[]},e.prototype.setSite=function(e){this.configuration.setSiteID(e.srcElement.value)},e.prototype.showForgotPassword=function(){this.showForgotPass?this.showForgotPass=!1:this.showForgotPass=!0},Object.defineProperty(e.prototype,"showExternalSidebar",{get:function(){try{var e=!_.isEmpty(this.configuration.data.loginSidebarUrl);return e&&null===this.externalSidebarUrl&&(this.externalSidebarUrl=this.sanitizer.bypassSecurityTrustResourceUrl(this.configuration.data.loginSidebarUrl)),e}catch(e){return!1}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showNewsfeed",{get:function(){try{return!!this.configuration.initialized&&_.isEmpty(this.configuration.data.loginSidebarUrl)}catch(e){return!1}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showProgressBar",{get:function(){return this.configuration.data.loginProgressBar},enumerable:!0,configurable:!0}),e=__decorate([core_1.Component({selector:"global-login",template:'<div class="slds-grid slds-is-absolute slds-size--1-of-1" style="height:100vh; top: 0px;"><div class="slds-align--absolute-center slds-size--1-of-2"><div class="slds-size--2-of-3"><div class="slds-align--absolute-center slds-p-vertical--medium"><img src="./config/loginimage"></div><div class="slds-box--border" *ngIf="!loginService.session.authData.sessionId && promptUser"><div class="slds-p-around--medium"><div *ngIf="!showForgotPass"><div class="slds-form-element slds-m-vertical--small"><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--left"><system-utility-icon [icon]="\'user\'" [addclasses]="\'slds-input__icon slds-icon-text-default\'"></system-utility-icon><input type="text" [(ngModel)]="username" class="slds-input slds-p-horizontal--large slds-p-vertical--small" tabindex="1"></div></div><div class="slds-form-element slds-m-vertical--small"><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--left"><system-utility-icon [icon]="\'lock\'" [addclasses]="\'slds-input__icon slds-icon-text-default\'"></system-utility-icon><input type="password" [(ngModel)]="password" class="slds-input slds-p-horizontal--large slds-p-vertical--small" tabindex="2"></div></div><div *ngIf="sites.length > 1" class="slds-form-element slds-m-vertical--small"><div class="slds-form-element__control"><div class="slds-select_container slds-m-vertical--xx-small"><select class="slds-select slds-p-horizontal--large" [ngModel]="currentSiteId" (change)="setSite($event)"><option *ngFor="let site of sites" [value]="site.id">{{site.display}}</option></select></div></div></div><div *ngIf="getLanguages().length > 1" class="slds-form-element slds-m-vertical--small"><div class="slds-form-element__control"><div class="slds-select_container slds-m-vertical--xx-small"><select class="slds-select slds-p-horizontal--large" name="selectLang" [(ngModel)]="selectedlanguage"><option *ngFor="let lang of getLanguages()" [value]="lang.language">{{lang.text}}</option></select></div></div></div><div class="slds-button slds-button--brand" style="width:100%;" (click)="login()" tabindex="0">Login</div><global-login-google (googletoken)="doLogin()"></global-login-google></div><div class="slds-p-vertical--x-small slds-grid slds-grid--align-spread slds-grid_vertical-align-center" *ngIf="configuration.getData(\'allowForgotPass\')"><div class="slds-truncate slds-text-body_small" title="Forgot password">Forgot password</div><button class="slds-button" (click)="showForgotPassword()"><system-button-icon *ngIf="!showForgotPass" [icon]="\'chevrondown\'" [size]="\'xx-small\'"></system-button-icon><system-button-icon *ngIf="showForgotPass" [icon]="\'chevronup\'" [size]="\'xx-small\'"></system-button-icon></button></div><global-login-forgot-password class="slds-col" *ngIf="showForgotPass" (hasNewPassword)="showForgotPass = $event"></global-login-forgot-password></div></div><global-login-reset-password *ngIf="loginService.session.authData.renewPass" [oldpassword]="password"></global-login-reset-password><ng-container *ngIf="loginService.session.authData.sessionId && !loginService.session.authData.renewPass"><div class="slds-align--absolute-center"><div class="slds-size--2-of-3"><div class="slds-progress-bar slds-progress-bar_circular slds-progress-bar_medium"><span class="slds-progress-bar__value" [style.width]="loginService.loader.progress+\'%\'" style="background-color:#aaa"></span></div><div class="slds-text-align--center slds-p-vertical--small">... loading {{loginService.loader.activeLoader}} ...</div></div></div></ng-container></div><div class="slds-is-absolute" style="bottom: 10px;">© 2015 - 2018 aac services k.s. All rights reserved.</div></div><div *ngIf="promptUser" class="slds-size--1-of-2" [class.slds-scrollable--y]="!showExternalSidebar"><iframe *ngIf="showExternalSidebar" [src]="externalSidebarUrl" style="border:none;width:100%;height:100%"></iframe><ng-container *ngIf="showNewsfeed"><global-newsfeed></global-newsfeed></ng-container></div></div>',host:{"(window:keypress)":"this.keypressed($event)"}}),__metadata("design:paramtypes",[services_1.loginService,http_1.HttpClient,services_4.configurationService,services_2.session,services_17.cookie,services_3.language,platform_browser_1.DomSanitizer])],e)}();exports.GlobalLogin=GlobalLogin;var GlobalSetup=function(){function e(e,s,t,o){this.toast=e,this.http=s,this.router=t,this.configurationService=o,this.systemid="000",this.systemname="",this.systemurl="",this.systemproxy=1,this.systemdevmode=0,this.systemloginprogressbar=1,this.systemallowforgotpass=0,this.checking=!1}return Object.defineProperty(e.prototype,"saveEnabled",{get:function(){return""!=this.systemname&&""!=this.systemurl&&!this.checking},enumerable:!0,configurable:!0}),e.prototype.testConnection=function(){var t=this;this.checking=!0,this.http.get("config/check",{params:{url:btoa(this.systemurl)}}).subscribe(function(e){var s=e;1!=s.success?(t.toast.sendToast(s.message,"error"),t.checking=!1):t.saveConnection()},function(e){e.status})},e.prototype.saveConnection=function(){var t=this;this.checking=!0;var e={id:this.systemid,display:this.systemname,backendUrl:this.systemurl,proxy:this.systemproxy,developerMode:this.systemdevmode,loginProgressBar:this.systemloginprogressbar,allowForgotPass:this.systemloginprogressbar};this.http.post("config/set",e,{}).subscribe(function(e){var s=e;1==s.success?(t.configurationService.setSiteData(s.site),t.router.navigate(["/login"])):t.checking=!1},function(e){e.status})},e=__decorate([core_1.Component({selector:"global-setup",template:'<div class="slds-align--absolute-center slds-p-around--medium" style="height: 80%;"><div class="slds-box" style="width: 50%;"><h2 class="slds-text-heading--medium slds-p-vertical--small slds-p-horizontal--x-small">Define Backend Connection</h2><div class="slds-form-element slds-p-vertical--xx-small"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr>id</label><div class="slds-form-element__control"><input type="text" class="slds-input" [disabled]="checking" [(ngModel)]="systemid"></div></div><div class="slds-form-element slds-p-vertical--xx-small"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr>Name</label><div class="slds-form-element__control"><input type="text" class="slds-input" [disabled]="checking" [(ngModel)]="systemname"></div></div><div class="slds-form-element slds-p-vertical--xx-small"><label class="slds-form-element__label"><abbr class="slds-required">*</abbr>Backend URL</label><div class="slds-form-element__control"><input type="text" class="slds-input" [disabled]="checking" [(ngModel)]="systemurl"></div></div><div class="slds-form-element slds-p-vertical--xx-small"><label class="slds-form-element__label">use proxy</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [disabled]="checking" [(ngModel)]="systemproxy"><option value="1">Yes</option><option value="0">No</option></select></div></div></div><div class="slds-form-element slds-p-vertical--xx-small"><label class="slds-form-element__label">developermode</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [disabled]="checking" [(ngModel)]="systemdevmode"><option value="1">Yes</option><option value="0">No</option></select></div></div></div><div class="slds-form-element slds-p-vertical--xx-small"><label class="slds-form-element__label">Show Loader Details</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [disabled]="checking" [(ngModel)]="systemloginprogressbar"><option value="0">Yes</option><option value="1">No</option></select></div></div></div><div class="slds-form-element slds-p-vertical--xx-small"><label class="slds-form-element__label">Show Forgot Password on Login Screen</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [disabled]="checking" [(ngModel)]="systemallowforgotpass"><option value="0">Yes</option><option value="1">No</option></select></div></div></div><div class="slds-text-align--right slds-p-vertical--small"><button class="slds-button slds-button--brand" [disabled]="!saveEnabled" (click)="testConnection()">Check & Save</button></div></div></div>'}),__metadata("design:paramtypes",[services_15.toast,http_1.HttpClient,router_1.Router,services_4.configurationService])],e)}();exports.GlobalSetup=GlobalSetup;var GlobalLoginForgotPassword=function(){function e(e,s,t){this.http=e,this.configuration=s,this.toast=t,this.email="",this.token="",this.password=void 0,this.repeatPassword=void 0,this.pwdCheck=new RegExp("//"),this.pwdGuideline="",this.infoLoaded=!1,this.emailEmpty=!1,this.tokenEmpty=!1,this.tokenInvalid=!1,this.promptUser=!1,this.showForgotPasswordEmail=!0,this.promptNewPass=!1,this.showForgotPasswordToken=!1,this.hasNewPassword=new core_1.EventEmitter,this.getInfo()}return e.prototype.getInfo=function(){var s=this;this.http.get(this.configuration.getBackendUrl()+"/forgotPassword/info").subscribe(function(e){s.pwdCheck=new RegExp(e.pwdCheck.regex),s.pwdGuideline=e.pwdCheck.guideline,s.infoLoaded=!0})},Object.defineProperty(e.prototype,"pwderror",{get:function(){return!(!this.password||this.pwdCheck.test(this.password))&&"Password does not match the Guideline."},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pwdreperror",{get:function(){return this.password!=this.repeatPassword&&"Inputs for the new Password does not match."},enumerable:!0,configurable:!0}),e.prototype.keypressed=function(e){13===e.keyCode&&(this.showForgotPasswordEmail&&this.sendEmail(),this.showForgotPasswordToken&&this.sendToken(),this.promptNewPass&&this.sendNewPass())},e.prototype.sendEmail=function(){var s=this;0<this.email.length?(this.emailEmpty=!1,this.http.get(this.configuration.getBackendUrl()+"/forgotPassword/"+this.email).subscribe(function(e){e?(s.showForgotPasswordToken=!0,s.showForgotPasswordEmail=!1,s.toast.sendToast("Successfully sent, check your inbox to get the token code","success")):s.toast.sendToast("User with the given email does not exist","error")},function(e){switch(e.status){case 401:s.showForgotPasswordEmail=!0}})):this.emailEmpty=!0},e.prototype.sendToken=function(){var t=this;0<this.token.length?(this.tokenEmpty=!1,this.http.post(this.configuration.getBackendUrl()+"/forgotPassword/"+this.email+"/"+this.token,{}).subscribe(function(e){var s=e;t.showForgotPasswordEmail=!1,s.token_valid?(t.showForgotPasswordToken=!1,t.promptNewPass=!0):(t.tokenInvalid=!0,t.toast.sendToast("Token or email is invalid","error","Token is expired, or invalid or does not belong to this email address",!1))},function(e){switch(e.status){case 401:t.showForgotPasswordToken=!0}})):this.emailEmpty=!0},e.prototype.sendNewPass=function(){var s=this;if(this.infoLoaded&&this.pwderror)return!1;this.password&&0==this.pwdreperror&&this.http.post(this.configuration.getBackendUrl()+"/forgotPassword/resetPass",{email:this.email,token:this.token,password:this.password}).subscribe(function(e){s.promptNewPass=!1,s.toast.sendToast("please log in with new password","default","please return to login form and enter login data with new password",!1),s.hasNewPassword.emit(!1)},function(e){switch(e.status){case 401:s.promptNewPass=!0}})},__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],e.prototype,"hasNewPassword",void 0),e=__decorate([core_1.Component({selector:"global-login-forgot-password",template:'<div id="login-forgot-password"><div class="slds-form-element slds-m-vertical--small" [ngClass]="{\'slds-has-error\': emailEmpty}"><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--left" *ngIf="showForgotPasswordEmail"><system-utility-icon [icon]="\'email\'" [addclasses]="\'slds-input__icon slds-icon-text-default\'"></system-utility-icon><input type="email" [(ngModel)]="email" class="slds-input slds-p-horizontal--large slds-p-vertical--small" tabindex="3" placeholder="Email address of your user account"></div></div><div class="slds-button slds-button--brand" (click)="sendEmail()" *ngIf="showForgotPasswordEmail">Send</div><div class="slds-form-element slds-m-vertical--small" [ngClass]="{\'slds-has-error\': (tokenEmpty || tokenInvalid)}"><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--left" *ngIf="showForgotPasswordToken"><system-utility-icon [icon]="\'shield\'" [addclasses]="\'slds-input__icon slds-icon-text-default\'"></system-utility-icon><input type="text" [(ngModel)]="token" class="slds-input slds-p-horizontal--large slds-p-vertical--small" tabindex="4" placeholder="Token that was sent via email"></div></div><div class="slds-button slds-button--brand" (click)="sendToken()" *ngIf="showForgotPasswordToken">Confirm</div><div class="spiceNewPasswordModal" *ngIf="promptNewPass"><div *ngIf="pwdGuideline" class="slds-m-vertical--medium">Password Guideline:<br>{{pwdGuideline}}</div><div class="slds-form-element slds-m-vertical--small" [ngClass]="{\'slds-has-error\': passField.touched && passField.dirty && pwderror}"><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--left"><system-utility-icon [icon]="\'lock\'" [addclasses]="\'slds-input__icon slds-icon-text-default\'"></system-utility-icon><input #passField="ngModel" type="password" [(ngModel)]="password" class="slds-input slds-p-horizontal--large slds-p-vertical--small" tabindex="1" placeholder="enter new password"></div><div *ngIf="passField.touched && passField.dirty && pwderror" class="slds-form-element__help slds-text-color--error">{{pwderror}}</div></div><div class="slds-form-element slds-m-vertical--small" [ngClass]="{\'slds-has-error\': repPassField.touched && repPassField.dirty && pwdreperror}"><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--left"><system-utility-icon [icon]="\'lock\'" [addclasses]="\'slds-input__icon slds-icon-text-default\'"></system-utility-icon><input type="password" #repPassField="ngModel" [(ngModel)]="repeatPassword" class="slds-input slds-p-horizontal--large slds-p-vertical--small" tabindex="2" placeholder="repeat new password"></div><div *ngIf="repPassField.touched && repPassField.dirty && pwdreperror" class="slds-form-element__help slds-text-color--error">{{pwdreperror}}</div></div><div class="slds-button slds-button--brand" (click)="sendNewPass()" tabindex="3">Save</div></div></div>',host:{"(window:keypress)":"this.keypressed($event)"}}),__metadata("design:paramtypes",[http_1.HttpClient,services_4.configurationService,services_15.toast])],e)}();exports.GlobalLoginForgotPassword=GlobalLoginForgotPassword;var GlobalLoginResetPassword=function(){function e(e,s,t,o,i){this.loginService=e,this.http=s,this.configuration=t,this.toast=o,this.session=i,this.oldPassword=void 0,this.password=void 0,this.repeatPassword=void 0,this.promptNewPass=!1,this.pwdCheck=new RegExp("//"),this.pwdGuideline=void 0,this.infoLoaded=!1,this.getInfo()}return Object.defineProperty(e.prototype,"oldPwError",{get:function(){return this.oldPassword==this.password&&"Old password is not allowed to be used as a new password"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pwderror",{get:function(){return!(!this.password||this.pwdCheck.test(this.password))&&"Password does not match the Guideline."},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pwdreperror",{get:function(){return this.password!=this.repeatPassword&&"Inputs for the new Password does not match."},enumerable:!0,configurable:!0}),e.prototype.keypressed=function(e){13===e.keyCode&&this.sendNewPass()},e.prototype.getInfo=function(){var s=this;this.http.get(this.configuration.getBackendUrl()+"/forgotPassword/info").subscribe(function(e){s.pwdCheck=new RegExp(e.pwdCheck.regex),s.pwdGuideline=e.pwdCheck.guideline,s.infoLoaded=!0})},e.prototype.sendNewPass=function(){var s=this;if(this.infoLoaded&&this.pwderror)return!1;if(this.password&&0==this.pwdreperror&&0==this.oldPwError){var e=new http_1.HttpHeaders;e=e.set("OAuth-Token",this.session.authData.sessionId),this.http.post(this.configuration.getBackendUrl()+"/resetTempPass",{password:this.password},{headers:e}).subscribe(function(e){s.session.authData.renewPass=!1,s.toast.sendToast("Password was successfully changed","success","",5),s.loginService.load()},function(e){switch(e.status){case 401:s.promptNewPass=!0}})}},__decorate([core_1.Input("oldpassword"),__metadata("design:type",String)],e.prototype,"oldPassword",void 0),e=__decorate([core_1.Component({selector:"global-login-reset-password",template:'<div id="reset-password"><div style="height: 640px;"><section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open"><div class="slds-modal__container"><header class="slds-modal__header"><button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close"><system-button-icon [icon]="\'close\'"></system-button-icon><span class="slds-assistive-text">Close</span></button><h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate">New password</h2></header><div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1"><div *ngIf="pwdGuideline" class="slds-m-vertical--medium">Password Guideline:<br>{{pwdGuideline}}</div><div class="slds-form-element slds-m-vertical--small" [ngClass]="{\'slds-has-error\': passField.touched && passField.dirty && (pwderror || oldPwError)}"><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--left"><system-utility-icon [icon]="\'lock\'" [addclasses]="\'slds-input__icon slds-icon-text-default\'"></system-utility-icon><input #passField="ngModel" type="password" [(ngModel)]="password" class="slds-input slds-p-horizontal--large slds-p-vertical--small" tabindex="1" placeholder="enter new password" autofocus></div><div *ngIf="passField.touched && passField.dirty && pwderror" class="slds-form-element__help slds-text-color--error">{{pwderror}}</div><div *ngIf="passField.touched && passField.dirty && oldPwError" class="slds-form-element__help slds-text-color--error">{{oldPwError}}</div></div><div class="slds-form-element slds-m-vertical--small" [ngClass]="{\'slds-has-error\': repPassField.touched && repPassField.dirty && pwdreperror}"><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--left"><system-utility-icon [icon]="\'lock\'" [addclasses]="\'slds-input__icon slds-icon-text-default\'"></system-utility-icon><input type="password" #repPassField="ngModel" [(ngModel)]="repeatPassword" class="slds-input slds-p-horizontal--large slds-p-vertical--small" tabindex="2" placeholder="repeat new password"></div><div *ngIf="repPassField.touched && repPassField.dirty && pwdreperror" class="slds-form-element__help slds-text-color--error">{{pwdreperror}}</div></div></div><footer class="slds-modal__footer"><button class="slds-button slds-button--brand" (click)="sendNewPass()" tabindex="3">Save</button></footer></div></section><div class="slds-backdrop slds-backdrop_open"></div></div></div>',host:{"(window:keypress)":"this.keypressed($event)"}}),__metadata("design:paramtypes",[services_1.loginService,http_1.HttpClient,services_4.configurationService,services_15.toast,services_2.session])],e)}();exports.GlobalLoginResetPassword=GlobalLoginResetPassword;var GlobalNavigation=function(){function e(e,s,t,o){this.menuService=e,this.metadata=s,this.elementRef=t,this.broadcast=o,this.resizeTimeOut=void 0,e.loadModules()}return __decorate([core_1.ViewChild("menucontainer",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"menucontainer",void 0),e=__decorate([core_1.Component({selector:"global-navigation",template:'<div class="slds-context-bar"><global-app-launcher></global-app-launcher><global-navigation-menu class="slds-context-bar__secondary" role="navigation"></global-navigation-menu></div>',providers:[MenuService]}),__metadata("design:paramtypes",[MenuService,services_11.metadata,core_1.ElementRef,services_6.broadcast])],e)}();exports.GlobalNavigation=GlobalNavigation;var GlobalNavigationMenu=function(){function e(e,s,t,o,i){var a=this;this.menuService=e,this.metadata=s,this.elementRef=t,this.broadcast=o,this.navigation=i,this.moreComponentRef=void 0,this.menuItems=[],this.renderedItems=[],this.moreItems=[],this.movingActive=!1,this.rendering=!1,this.resizeTimeOut=void 0,this.broadcast.message$.subscribe(function(e){a.handleMessage(e)}),this.navigation.activeModule$.subscribe(function(e){return a.checkActiveModule()})}return e.prototype.ngAfterViewInit=function(){this.buildMenuItems(),this.renderMenu()},e.prototype.buildMenuItems=function(){this.menuItems=["Home"];for(var e=0,s=this.metadata.getRoleModules(!0);e<s.length;e++){var t=s[e];this.menuItems.push(t)}},e.prototype.handleResize=function(){var e=this;this.buildMenuItems(),this.resizeTimeOut&&window.clearTimeout(this.resizeTimeOut),this.resizeTimeOut=window.setTimeout(function(){return e.renderMenu()},250)},e.prototype.checkActiveModule=function(){if(this.movingActive||this.rendering)return!1;for(var e=this.menuItems.indexOf(this.navigation.activeModule),s=!1,t=0,o=this.renderedItems;t<o.length;t++){if(o[t].module==this.navigation.activeModule){s=!0;break}}if(!s&&0!=e&&e+1>this.renderedItems.length){var i=this.menuItems.splice(e,1),a=this.renderedItems.pop();return a&&(a.componentRef.destroy(),this.menuItems.splice(this.renderedItems.length,0,i[0]),this.movingActive=!0,this.destroyMoreItem(),this.addMenuItem(this.menuItems[this.renderedItems.length],this.menuItems[this.renderedItems.length])),!1}return!0},e.prototype.destroyMenu=function(){for(var e=0,s=this.renderedItems;e<s.length;e++){s[e].componentRef.destroy()}this.renderedItems=[],this.destroyMoreItem(),this.movingActive=!1},e.prototype.renderMenu=function(){this.destroyMenu(),this.rendering=!0,this.addMenuItem(this.menuItems[0],this.menuItems[0])},e.prototype.addMenuItem=function(s,t){var o=this;this.metadata.addComponentDirect("GlobalNavigationMenuItem",this.menucontainer).subscribe(function(e){e.instance.item={module:s,name:t},o.renderedItems.push({module:s,componentRef:e})})},e.prototype.addMoreItem=function(){var t=this;this.destroyMoreItem(),this.metadata.addComponentDirect("GlobalNavigationMenuMore",this.menucontainer).subscribe(function(e){t.moreItems=[];for(var s=t.renderedItems.length;s<t.menuItems.length;)t.moreItems.push(t.menuItems[s]),s++;e.instance.moreMenuItems=t.moreItems,t.moreComponentRef={componentRef:e}})},e.prototype.destroyMoreItem=function(){this.moreComponentRef&&(this.moreComponentRef.componentRef.destroy(),this.moreComponentRef=void 0)},e.prototype.getRenderedWidth=function(){for(var e=0,s=0,t=this.renderedItems;s<t.length;s++){e+=t[s].width}return e},e.prototype.handleMessage=function(e){switch(e.messagetype){case"applauncher.setrole":this.buildMenuItems(),this.renderMenu();break;case"navigation.itemadded":for(var s=0,t=this.renderedItems;s<t.length;s++){var o=t[s];o.module===e.messagedata.module&&(o.width=e.messagedata.width)}var i=this.getRenderedWidth();if(this.movingActive)this.elementRef.nativeElement.offsetWidth,this.movingActive=!1,this.addMoreItem();else if(i>this.elementRef.nativeElement.offsetWidth)this.renderedItems.pop().componentRef.destroy(),this.menuItems.length>this.renderedItems.length?this.addMoreItem():this.rendering=!1;else this.menuItems.length>this.renderedItems.length&&this.addMenuItem(this.menuItems[this.renderedItems.length],this.menuItems[this.renderedItems.length]);break;case"navigation.moreadded":if(this.moreComponentRef.width=e.messagedata.width,0<this.renderedItems.length&&this.getRenderedWidth()+e.messagedata.width>this.elementRef.nativeElement.offsetWidth)this.renderedItems.pop().componentRef.destroy(),this.checkActiveModule()&&this.addMoreItem()}},__decorate([core_1.ViewChild("menucontainer",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"menucontainer",void 0),__decorate([core_1.ViewChild("morecontainer",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"morecontainer",void 0),e=__decorate([core_1.Component({selector:"global-navigation-menu",template:'<ul class="slds-grid"><div #menucontainer></div><div #morecontainer></div></ul>',providers:[MenuService],host:{"(window:resize)":"handleResize()"}}),__metadata("design:paramtypes",[MenuService,services_11.metadata,core_1.ElementRef,services_6.broadcast,services_12.navigation])],e)}();exports.GlobalNavigationMenu=GlobalNavigationMenu;var GlobalNavigationMenuItem=function(){function GlobalNavigationMenuItem(e,s,t,o,i,a,l,n,r,d,c){this.metadata=e,this.language=s,this.router=t,this.elementRef=o,this.broadcast=i,this.navigation=a,this.popup=l,this.model=n,this.recent=r,this.favorite=d,this.renderer=c,this.itemtext="test",this.item={module:null,name:null},this.isOpen=!1,this.isInitialized=!1,this.itemMenu=[],this.favorites=[],this.recentItems=[],this.menucomponents=[]}return GlobalNavigationMenuItem.prototype.executeMenuItem=function(t){var o=this;this.itemMenu.some(function(e,s){if(e.id===t){switch(e.action){case"add":o.isOpen=!1,o.model.addModel()}return!0}})},GlobalNavigationMenuItem.prototype.navigateTo=function(){this.isOpen=!1,this.router.navigate(["/module/"+this.item.module])},GlobalNavigationMenuItem.prototype.navigateRecent=function(e){this.isOpen=!1,this.router.navigate(["/module/"+this.item.module+"/"+e])},GlobalNavigationMenuItem.prototype.editRecent=function(e){this.isOpen=!1,this.model.id=e,this.model.edit(!0)},GlobalNavigationMenuItem.prototype.ngOnInit=function(){this.itemMenu=this.metadata.getModuleMenu(this.item.module),this.model.module=this.item.module},GlobalNavigationMenuItem.prototype.toggleOpen=function(){var s=this;this.isInitialized||this.initialize(),this.isOpen=!this.isOpen,this.isOpen?(this.favorites=this.getFavorites(),this.recentItems=this.recentitems,this.buildMenu(),this.clickListener=this.renderer.listen("document","click",function(e){return s.onClick(e)})):this.clickListener&&this.clickListener()},GlobalNavigationMenuItem.prototype.initialize=function(){var s=this,e=this.recent.getModuleRecent(this.item.module);e instanceof Array?this.isInitialized=!0:e.subscribe(function(e){s.isInitialized=!0})},Object.defineProperty(GlobalNavigationMenuItem.prototype,"recentitems",{get:function(){return this.recent.moduleItems[this.item.module]?this.recent.moduleItems[this.item.module]:[]},enumerable:!0,configurable:!0}),GlobalNavigationMenuItem.prototype.getFavorites=function(){return this.favorite.getFavorites(this.item.module)},GlobalNavigationMenuItem.prototype.onClick=function(e){(!this.elementRef.nativeElement.contains(e.target)||this.elementRef.nativeElement.contains(e.target)&&this.menulist.element.nativeElement.contains(e.target))&&(this.isOpen=!1)},GlobalNavigationMenuItem.prototype.hasMenu=function(){return 0<this.itemMenu.length||this.metadata.getModuleTrackflag(this.item.module)},GlobalNavigationMenuItem.prototype.getMenuLabel=function(e){return this.language.getModuleLabel(this.item.module,e)},GlobalNavigationMenuItem.prototype.isActive=function(){return this.navigation.activeModule==this.item.module},GlobalNavigationMenuItem.prototype.ngAfterViewInit=function(){this.broadcast.broadcastMessage("navigation.itemadded",{module:this.item.module,width:this.elementRef.nativeElement.offsetWidth}),this.model.module=this.item.module},GlobalNavigationMenuItem.prototype.buildMenu=function(){var t=this;this.destroyMenu();for(var e=function(s){switch(s.action){case"NEW":o.metadata.checkModuleAcl(o.item.module,"create")&&o.metadata.addComponent("GlobalNavigationMenuItemNew",o.menucontainer).subscribe(function(e){t.menucomponents.push(e)});break;case"ROUTE":o.metadata.addComponent("GlobalNavigationMenuItemRoute",o.menucontainer).subscribe(function(e){e.instance.actionconfig=s.actionconfig,t.menucomponents.push(e)})}},o=this,s=0,i=this.itemMenu;s<i.length;s++){e(i[s])}},GlobalNavigationMenuItem.prototype.destroyMenu=function(){for(var e=0,s=this.menucomponents;e<s.length;e++){s[e].destroy()}},GlobalNavigationMenuItem.prototype.ngOnDestroy=function(){this.destroyMenu()},__decorate([core_1.ViewChild("menulist",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],GlobalNavigationMenuItem.prototype,"menulist",void 0),__decorate([core_1.ViewChild("menucontainer",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],GlobalNavigationMenuItem.prototype,"menucontainer",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],GlobalNavigationMenuItem.prototype,"itemtext",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],GlobalNavigationMenuItem.prototype,"item",void 0),GlobalNavigationMenuItem=__decorate([core_1.Component({selector:"global-navigation-menu-item",template:'<li class="slds-context-bar__dropdown-trigger slds-dropdown-trigger slds-dropdown-trigger--click" [ngClass]="{\'slds-is-open\': isOpen}" aria-haspopup="true"><a href="javascript:void(0);" class="slds-context-bar__label-action" (click)="navigateTo()"><span class="slds-truncate">{{language.getModuleName(item.name)}}</span></a><div *ngIf="hasMenu()" class="slds-context-bar__icon-action slds-p-left--none"><button class="slds-button slds-button--icon slds-context-bar__button" (click)="toggleOpen()"><system-button-icon [icon]="\'chevrondown\'"></system-button-icon></button></div><div class="slds-dropdown slds-nubbin--top"><ul #menulist class="slds-dropdown__list" role="menu"><div #menucontainer></div><li *ngIf="menucomponents.length > 0" class="slds-has-divider--top-space" role="separator"></li><ng-container *ngIf="favorites.length > 0"><li class="slds-dropdown__header" role="separator"><span class="slds-text-title--caps">{{language.getLabel(\'LBL_FAVORITES\')}}</span></li><li *ngFor="let favorite of favorites" class="slds-dropdown__item" role="presentation" (click)="navigateRecent(favorite.item_id)"><a href="javascript:void(0);" role="menuitem"><span class="slds-truncate">{{favorite.item_summary}}</span></a></li><li class="slds-has-divider--top-space" role="separator"></li></ng-container><li class="slds-dropdown__header" role="separator"><span class="slds-text-title--caps">{{language.getLabel(\'LBL_RECENTLYVIEWED\')}}</span></li><li *ngFor="let recentItem of recentitems" class="slds-dropdown__item" role="presentation" (click)="navigateRecent(recentItem.item_id)"><a href="javascript:void(0);" role="menuitem"><span class="slds-truncate">{{recentItem.item_summary}}</span></a></li><li class="slds-dropdown__item slds-align--absolute-center slds-text-color_inverse-weak slds-p-around--xx-small" *ngIf="recentitems.length == 0 && isInitialized">{{language.getLabel(\'LBL_NO_ENTRIES\')}}</li></ul><system-spinner *ngIf="!isInitialized" size="16"></system-spinner></div></li>',host:{"[class.slds-context-bar__item]":"true","[class.slds-is-active]":"isActive()"},providers:[services_5.popup,services_8.model]}),__metadata("design:paramtypes",[services_11.metadata,services_3.language,router_1.Router,core_1.ElementRef,services_6.broadcast,services_12.navigation,services_5.popup,services_8.model,services_9.recent,services_10.favorite,core_1.Renderer2])],GlobalNavigationMenuItem)}();exports.GlobalNavigationMenuItem=GlobalNavigationMenuItem;var GlobalNavigationMenuItemNew=function(){function GlobalNavigationMenuItemNew(e,s,t,o){this.metadata=e,this.language=s,this.model=t,this.renderer=o}return GlobalNavigationMenuItemNew.prototype.exceuteItem=function(){this.model.addModel()},GlobalNavigationMenuItemNew=__decorate([core_1.Component({selector:"global-navigation-menu-item-new",template:'<li class="slds-dropdown__item" role="presentation" (click)="exceuteItem()"><a href="javascript:void(0);" role="menuitem"><span class="slds-truncate"><global-nevigation-menu-item-icon [icon]="\'add\'"></global-nevigation-menu-item-icon>{{language.getModuleName(model.module, true)}}</span></a></li>'}),__metadata("design:paramtypes",[services_11.metadata,services_3.language,services_8.model,core_1.Renderer2])],GlobalNavigationMenuItemNew)}();exports.GlobalNavigationMenuItemNew=GlobalNavigationMenuItemNew;var GlobalNavigationMenuItemRoute=function(){function GlobalNavigationMenuItemRoute(e,s,t,o){this.metadata=e,this.language=s,this.model=t,this.router=o,this.actionconfig={}}return Object.defineProperty(GlobalNavigationMenuItemRoute.prototype,"actionicon",{get:function(){return this.actionconfig.icon?this.actionconfig.icon:"chevronright"},enumerable:!0,configurable:!0}),Object.defineProperty(GlobalNavigationMenuItemRoute.prototype,"actionlabel",{get:function(){if(this.actionconfig.label&&-1<this.actionconfig.label.indexOf(":")){var e=this.actionconfig.label.split(":");return this.language.getLabel(e[0],e[1])}return this.language.getLabel(this.actionconfig.label)},enumerable:!0,configurable:!0}),GlobalNavigationMenuItemRoute.prototype.exceuteItem=function(){this.router.navigate([this.actionconfig.route])},GlobalNavigationMenuItemRoute=__decorate([core_1.Component({selector:"global-navigation-menu-item-route",template:'<li class="slds-dropdown__item" role="presentation" (click)="exceuteItem()"><a href="javascript:void(0);" role="menuitem"><span class="slds-truncate"><global-nevigation-menu-item-icon [icon]="actionicon"></global-nevigation-menu-item-icon>{{actionlabel}}</span></a></li>'}),__metadata("design:paramtypes",[services_11.metadata,services_3.language,services_8.model,router_1.Router])],GlobalNavigationMenuItemRoute)}();exports.GlobalNavigationMenuItemRoute=GlobalNavigationMenuItemRoute;var GlobalNavigationMenuItemIcon=function(){function e(){this.icon=""}return e.prototype.getSvgHRef=function(){return"./sldassets/icons/utility-sprite/svg/symbols.svg#"+this.icon},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"icon",void 0),e=__decorate([core_1.Component({selector:"global-nevigation-menu-item-icon",template:'<svg aria-hidden="true" class="slds-icon slds-icon--x-small slds-icon-text-default slds-m-right--x-small"><use [attr.xlink:href]="getSvgHRef()"></use></svg>'})],e)}();exports.GlobalNavigationMenuItemIcon=GlobalNavigationMenuItemIcon;var GlobalNavigationMenuMore=function(){function GlobalNavigationMenuMore(e,s,t,o){this.language=e,this.router=s,this.elementRef=t,this.broadcast=o,this.moreMenuItems=[]}return GlobalNavigationMenuMore.prototype.navigateTo=function(e){this.router.navigate(["/module/"+e])},GlobalNavigationMenuMore.prototype.ngAfterViewInit=function(){this.broadcast.broadcastMessage("navigation.moreadded",{module:"more",width:this.elementRef.nativeElement.offsetWidth})},GlobalNavigationMenuMore=__decorate([core_1.Component({selector:"global-navigation-menu-more",template:'<li class="slds-context-bar__dropdown-trigger slds-dropdown-trigger slds-dropdown-trigger--hover" aria-haspopup="true"><a href="javascript:void(0);" class="slds-context-bar__label-action"><span class="slds-truncate">{{language.getLabel(\'LBL_MORE\')}}</span></a><div class="slds-context-bar__icon-action slds-p-left--none"><button class="slds-button slds-button--icon slds-context-bar__button"><system-button-icon [icon]="\'down\'"></system-button-icon></button></div><div class="slds-dropdown slds-dropdown--right"><ul class="slds-dropdown__list" role="menu"><li *ngFor="let item of moreMenuItems" class="slds-dropdown__item" role="presentation" (click)="navigateTo(item)"><a href="javascript:void(0);" role="menuitem"><span class="slds-truncate">{{language.getModuleName(item)}}</span></a></li></ul></div></li>',host:{"[class.slds-context-bar__item]":"true"}}),__metadata("design:paramtypes",[services_3.language,router_1.Router,core_1.ElementRef,services_6.broadcast])],GlobalNavigationMenuMore)}();exports.GlobalNavigationMenuMore=GlobalNavigationMenuMore;var GlobalDockedComposerContainer=function(){function e(e){this.dockedComposer=e}return e.prototype.closeComposer=function(){this.dockedComposer.showComposer=!1},e.prototype.getComposerStyle=function(e){if(e>=this.dockedComposer.maxComposers)return{display:"none"}},Object.defineProperty(e.prototype,"displayOverflow",{get:function(){return this.dockedComposer.composers.length>this.dockedComposer.maxComposers},enumerable:!0,configurable:!0}),e=__decorate([core_1.Component({selector:"global-docked-composer-container",template:'<global-docked-composer-overflow *ngIf="displayOverflow"></global-docked-composer-overflow><global-docked-composer *ngFor="let composer of dockedComposer.composers; let i = index;" [composerindex]="i" [composerdata]="composer" [ngStyle]="getComposerStyle(i)"></global-docked-composer>'}),__metadata("design:paramtypes",[services_13.dockedComposer])],e)}();exports.GlobalDockedComposerContainer=GlobalDockedComposerContainer;var GlobalDockedComposer=function(){function GlobalDockedComposer(e,s,t,o,i,a,l){this.metadata=e,this.dockedComposer=s,this.language=t,this.model=o,this.view=i,this.modal=a,this.ViewContainerRef=l,this.composerdata={},this.isClosed=!1,this.view.isEditable=!0,this.view.setEditMode()}return GlobalDockedComposer.prototype.ngOnInit=function(){this.model.module=this.composerdata.module,this.model.id=this.composerdata.id,this.composerdata.model.data?this.model.data=this.composerdata.model.data:this.model.initializeModel(),this.dockedComposer.composers[this.composerindex].model=this.model;var s=this.metadata.getComponentConfig("GlobalDockedComposer",this.model.module);if(s.componentset)for(var e=this.metadata.getComponentSetObjects(s.componentset),t=function(s){o.metadata.addComponent("ObjectRecordFieldset",o.containercontent).subscribe(function(e){e.instance.componentconfig=s.componentconfig})},o=this,i=0,a=e;i<a.length;i++){t(a[i])}else s.fieldset&&this.metadata.addComponent("ObjectRecordFieldset",this.containercontent).subscribe(function(e){e.instance.direction="vertical",e.instance.fieldset=s.fieldset})},Object.defineProperty(GlobalDockedComposer.prototype,"displayLabel",{get:function(){return this.model.data.name?this.model.data.name:this.language.getModuleName(this.model.module,!0)},enumerable:!0,configurable:!0}),GlobalDockedComposer.prototype.toggleClosed=function(){this.isClosed=!this.isClosed},Object.defineProperty(GlobalDockedComposer.prototype,"toggleIcon",{get:function(){return this.isClosed?"erect_window":"minimize_window"},enumerable:!0,configurable:!0}),GlobalDockedComposer.prototype.expand=function(){this.modal.openModal("GlobalDockedComposerModal",!0,this.ViewContainerRef.injector)},GlobalDockedComposer.prototype.closeComposer=function(){for(var e=0;e<this.dockedComposer.composers.length;e++)this.dockedComposer.composers[e].id===this.composerdata.id&&this.dockedComposer.composers.splice(e,1)},GlobalDockedComposer.prototype.saveComposer=function(){var t=this;this.model.save().subscribe(function(e){for(var s=0;s<t.dockedComposer.composers.length;s++)t.dockedComposer.composers[s].id===t.composerdata.id&&t.dockedComposer.composers.splice(s,1)})},__decorate([core_1.ViewChild("containercontent",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],GlobalDockedComposer.prototype,"containercontent",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],GlobalDockedComposer.prototype,"composerdata",void 0),__decorate([core_1.Input(),__metadata("design:type",Number)],GlobalDockedComposer.prototype,"composerindex",void 0),GlobalDockedComposer=__decorate([core_1.Component({selector:"global-docked-composer",template:'<section class="slds-docked-composer slds-grid slds-grid_vertical slds-m-horizontal--x-small" [ngClass]="{\'slds-is-closed\': isUserClosed, \'slds-is-open\' : !isUserClosed}" role="dialog"><header class="slds-docked-composer__header slds-grid slds-shrink-none" aria-live="assertive"><div class="slds-media slds-media_center slds-no-space"><div class="slds-media__figure slds-m-right_x-small"><span class="slds-icon_container"><system-icon [module]="model.module" [size]="\'small\'"></system-icon></span></div><div class="slds-media__body"><h2 class="slds-truncate">{{displayLabel}}</h2></div></div><div class="slds-col_bump-left slds-shrink-none"><button class="slds-button slds-button_icon slds-button_icon" (click)="toggleClosed()"><system-button-icon [icon]="toggleIcon"></system-button-icon></button> <button class="slds-button slds-button_icon slds-button_icon" (click)="expand()"><system-button-icon [icon]="\'expand_alt\'"></system-button-icon></button> <button class="slds-button slds-button_icon slds-button_icon" (click)="closeComposer()"><system-button-icon [icon]="\'close\'"></system-button-icon></button></div></header><div class="slds-docked-composer__body slds-theme--default slds-scrollable" style="height: 380px;"><div #containercontent></div></div><footer class="slds-docked-composer__footer slds-shrink-none"><div class="slds-col_bump-left slds-text-align_right"><button class="slds-button slds-button--neutral" (click)="closeComposer()">{{language.getLabel(\'LBL_CANCEL\')}}</button> <button class="slds-button slds-button--brand" (click)="saveComposer()">{{language.getLabel(\'LBL_SAVE\')}}</button></div></footer></section>',providers:[services_8.model,services_14.view]}),__metadata("design:paramtypes",[services_11.metadata,services_13.dockedComposer,services_3.language,services_8.model,services_14.view,services_18.modal,core_1.ViewContainerRef])],GlobalDockedComposer)}();exports.GlobalDockedComposer=GlobalDockedComposer;var GlobalDockedComposerModal=function(){function GlobalDockedComposerModal(e,s,t,o,i){this.metadata=e,this.dockedComposer=s,this.language=t,this.model=o,this.view=i,this.self={},this.isClosed=!1,this.view.isEditable=!0,this.view.setEditMode()}return GlobalDockedComposerModal.prototype.setModel=function(e){this.model.id=e.id,this.model.module=e.module,this.model.data=e.data},GlobalDockedComposerModal.prototype.ngOnInit=function(){var s=this.metadata.getComponentConfig("GlobalDockedComposerModal",this.model.module);if(s.fieldset||s.componentset||(s=this.metadata.getComponentConfig("GlobalDockedComposer",this.model.module)),s.componentset)for(var e=this.metadata.getComponentSetObjects(s.componentset),t=function(s){o.metadata.addComponent(s.component,o.containercontent).subscribe(function(e){e.instance.componentconfig=s.componentconfig})},o=this,i=0,a=e;i<a.length;i++){t(a[i])}else s.fieldset&&this.metadata.addComponent("ObjectRecordFieldset",this.containercontent).subscribe(function(e){e.instance.direction="vertical",e.instance.fieldset=s.fieldset})},Object.defineProperty(GlobalDockedComposerModal.prototype,"displayLabel",{get:function(){return this.model.data.name?this.model.data.name:this.language.getModuleName(this.model.module,!0)},enumerable:!0,configurable:!0}),GlobalDockedComposerModal.prototype.minimize=function(){this.self.destroy()},GlobalDockedComposerModal.prototype.closeComposer=function(){for(var e=0;e<this.dockedComposer.composers.length;e++)this.dockedComposer.composers[e].id===this.model.id&&this.dockedComposer.composers.splice(e,1);this.self.destroy()},GlobalDockedComposerModal.prototype.saveComposer=function(){var t=this;this.model.save().subscribe(function(e){for(var s=0;s<t.dockedComposer.composers.length;s++)t.dockedComposer.composers[s].id===t.model.id&&t.dockedComposer.composers.splice(s,1);t.self.destroy()})},__decorate([core_1.ViewChild("containercontent",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],GlobalDockedComposerModal.prototype,"containercontent",void 0),GlobalDockedComposerModal=__decorate([core_1.Component({selector:"global-docked-composer-modal",template:'<system-modal size="medium"><system-modal-header [module]="model.module" (close)="minimize()">{{displayLabel}}</system-modal-header><system-modal-content><div #containercontent></div></system-modal-content><system-modal-footer><div class="slds-col_bump-left slds-text-align_right"><button class="slds-button slds-button--neutral" (click)="closeComposer()">{{language.getLabel(\'LBL_CANCEL\')}}</button> <button class="slds-button slds-button--brand" (click)="saveComposer()">{{language.getLabel(\'LBL_SAVE\')}}</button></div></system-modal-footer></system-modal>'}),__metadata("design:paramtypes",[services_11.metadata,services_13.dockedComposer,services_3.language,services_8.model,services_14.view])],GlobalDockedComposerModal)}();exports.GlobalDockedComposerModal=GlobalDockedComposerModal;var GlobalDockedComposerOverflow=function(){function e(e,s,t,o){this.renderer=e,this.elementRef=s,this.dockedComposer=t,this.language=o,this.showHiddenComposers=!1}return e.prototype.ngOnDestroy=function(){this.clickListener()},Object.defineProperty(e.prototype,"hiddenCount",{get:function(){return this.dockedComposer.composers.length-this.dockedComposer.maxComposers},enumerable:!0,configurable:!0}),e.prototype.toggleHiddenComoposers=function(){var s=this;this.showHiddenComposers=!this.showHiddenComposers,this.showHiddenComposers?this.clickListener=this.renderer.listen("document","click",function(e){return s.onClick(e)}):this.clickListener&&this.clickListener()},e.prototype.onClick=function(e){this.elementRef.nativeElement.contains(e.target)||(this.showHiddenComposers=!1,this.clickListener())},Object.defineProperty(e.prototype,"overflowComposers",{get:function(){return this.dockedComposer.composers.slice(this.dockedComposer.maxComposers)},enumerable:!0,configurable:!0}),e.prototype.displayLabel=function(e){return e.model.data.name?e.model.data.name:this.language.getModuleLabel(e.module,"LBL_NEW_FORM_TITLE")},e.prototype.focusComposer=function(e){this.dockedComposer.focusComposer(e),this.showHiddenComposers=!1},e=__decorate([core_1.Component({selector:"global-docked-composer-overflow",template:'<div class="slds-docked-composer slds-docked-composer_overflow slds-m-horizontal--x-small"><button class="slds-button slds-button_icon slds-docked-composer_overflow__button" (click)="toggleHiddenComoposers()"><system-button-icon [icon]="\'standard_objects\'"></system-button-icon><span class="slds-text-body_small slds-m-left_xx-small">{{hiddenCount}}</span></button><div class="slds-dropdown slds-dropdown_left slds-dropdown_bottom slds-dropdown_medium slds-nubbin_bottom-left" *ngIf="showHiddenComposers"><ul class="slds-dropdown__list slds-dropdown_length-with-icon-7" role="menu"><li class="slds-dropdown__item" role="presentation" *ngFor="let overflowComposer of overflowComposers"><a href="javascript:void(0);" role="menuitem" (click)="focusComposer(overflowComposer.id)"><div class="slds-media slds-media_center slds-no-space"><div class="slds-media__figure slds-m-right_x-small"><span class="slds-icon_container"><system-icon [module]="overflowComposer.module" [size]="\'small\'"></system-icon></span></div><div class="slds-media__body"><h2 class="slds-truncate">{{displayLabel(overflowComposer)}}</h2></div></div></a></li></ul></div></div>'}),__metadata("design:paramtypes",[core_1.Renderer2,core_1.ElementRef,services_13.dockedComposer,services_3.language])],e)}();exports.GlobalDockedComposerOverflow=GlobalDockedComposerOverflow;var GlobalComposeButton=function(){function e(e){this.dockedComposer=e,this.module=""}return e.prototype.showComposer=function(){this.dockedComposer.addComposer(this.module)},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"module",void 0),e=__decorate([core_1.Component({selector:"global-compose-button",template:'<div class="slds-no-flex"><button class="slds-button slds-button--neutral" (click)="showComposer()">New</button></div>'}),__metadata("design:paramtypes",[services_13.dockedComposer])],e)}();exports.GlobalComposeButton=GlobalComposeButton;var GlobalAppLauncher=function(){function e(e,s,t,o,i){this.metadata=e,this.modal=s,this.language=t,this.router=o,this.broadcast=i}return e.prototype.getRoleName=function(){var e=this.metadata.getActiveRole();return e.label&&""!=e.label?this.language.getLabel(e.label):this.metadata.getActiveRole().name},e.prototype.showAppLauncher=function(){this.modal.openModal("GlobalAppLauncherDialog")},e=__decorate([core_1.Component({selector:"global-app-launcher",template:'<div class="slds-context-bar__item slds-context-bar__dropdown-trigger slds-dropdown-trigger slds-dropdown-trigger--click slds-no-hover"><div class="slds-context-bar__icon-action slds-m-top_small" (click)="showAppLauncher()"><a href="javascript:void(0);" class="slds-icon-waffle_container slds-context-bar__button"><div class="slds-icon-waffle"><div class="slds-r1"></div><div class="slds-r2"></div><div class="slds-r3"></div><div class="slds-r4"></div><div class="slds-r5"></div><div class="slds-r6"></div><div class="slds-r7"></div><div class="slds-r8"></div><div class="slds-r9"></div></div></a></div><span class="slds-context-bar__label-action slds-context-bar__app-name"><span class="slds-truncate">{{getRoleName()}}</span></span></div>',host:{class:"slds-context-bar__primary slds-context-bar__item--divider-right"}}),__metadata("design:paramtypes",[services_11.metadata,services_18.modal,services_3.language,router_1.Router,services_6.broadcast])],e)}();exports.GlobalAppLauncher=GlobalAppLauncher;var GlobalAppLauncherDialog=function(){function GlobalAppLauncherDialog(e,s,t,o){this.metadata=e,this.language=s,this.router=t,this.broadcast=o,this.searchTerm="",this.self=void 0,this.toggleShowRoles=!0,this.toggleShowModules=!0}return Object.defineProperty(GlobalAppLauncherDialog.prototype,"showRoles",{get:function(){return 1<this.metadata.getRoles().length},enumerable:!0,configurable:!0}),GlobalAppLauncherDialog.prototype.toggleShow=function(e){switch(e){case"roles":this.toggleShowRoles=!this.toggleShowRoles;break;case"modules":this.toggleShowModules=!this.toggleShowModules}},GlobalAppLauncherDialog.prototype.hideAppLauncher=function(){this.self.destroy()},GlobalAppLauncherDialog.prototype.getRoleName=function(){return this.metadata.getActiveRole().name},GlobalAppLauncherDialog.prototype.getRoleLabel=function(s,e){var t=this.getRoles(),o=void 0;if(t.some(function(e){if(e.id==s)return o=e,!0}),!o.label||""==o.label)return o[e];switch(e){case"identifier":return this.language.getAppLanglabel(o.label,"short");case"name":return this.language.getAppLanglabel(o.label);case"description":return this.language.getAppLanglabel(o.label,"long")}},GlobalAppLauncherDialog.prototype.getRoles=function(){return this.metadata.getRoles()},GlobalAppLauncherDialog.prototype.setRole=function(e){this.metadata.setActiveRole(e),this.broadcast.broadcastMessage("applauncher.setrole",e),this.hideAppLauncher()},GlobalAppLauncherDialog.prototype.getModules=function(){for(var t=this,e=[],s=0,o=this.metadata.getModules();s<o.length;s++){var i=o[s];this.metadata.getModuleDefs(i).visible&&this.metadata.checkModuleAcl(i,"list")&&(""===this.searchTerm||""!==this.searchTerm&&this.language.getModuleName(i)&&0<=this.language.getModuleName(i).toLowerCase().indexOf(this.searchTerm.toLowerCase()))&&e.push(i)}return e.sort(function(e,s){return t.language.getModuleName(e)>t.language.getModuleName(s)?1:-1}),e},GlobalAppLauncherDialog.prototype.gotoModule=function(e){this.hideAppLauncher(),this.router.navigate(["/module/"+e])},GlobalAppLauncherDialog=__decorate([core_1.Component({selector:"global-app-launcher-dialog",template:'<div role="dialog" class="slds-modal slds-fade-in-open slds-modal--large slds-app-launcher"><div class="slds-modal__container"><div class="slds-modal__header slds-app-launcher__header slds-grid slds-grid--align-spread slds-grid--vertical-align-center"><button class="slds-button slds-modal__close slds-button--icon-inverse" title="Close" (click)="hideAppLauncher()"><system-button-icon [icon]="\'close\'" [size]="\'large\'"></system-button-icon></button><h2 class="slds-text-heading--medium">{{language.getLabel(\'LBL_APP_LAUNCHER\')}}</h2><div class="slds-app-launcher__header-search"><div class="slds-form-element"><div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--left"><system-utility-icon [icon]="\'search\'" [addclasses]="\'slds-input__icon slds-input__icon--left\'"></system-utility-icon><input type="search" class="slds-input" [(ngModel)]="searchTerm" [placeholder]="language.getLabel(\'LBL_FIND_CONFMODULE\')" autofocus></div></div></div><button class="slds-button slds-button--neutral" disabled>App Store</button></div><div class="slds-modal__content slds-app-launcher__content slds-p-around--medium"><ng-container *ngIf="showRoles"><div class="slds-section slds-is-open"><div class="slds-section__title"><button (click)="toggleShow(\'roles\')" class="slds-button slds-button--icon slds-m-right--small"><system-button-icon [icon]="\'switch\'"></system-button-icon></button><h3>{{language.getLabel(\'LBL_ROLES\')}}</h3></div><div *ngIf="toggleShowRoles" class="slds-section__content"><ul class="slds-grid slds-grid--pull-padded slds-wrap"><li *ngFor="let role of getRoles()" class="slds-p-horizontal--small slds-size--1-of-1 slds-medium-size--1-of-3" (click)="setRole(role.id)"><a href="javascript:void(0);" style="height: 110px;" class="slds-app-launcher__tile slds-text-link--reset slds-is-draggable"><div class="slds-app-launcher__tile-figure"><span class="slds-avatar slds-avatar--large slds-align--absolute-center {{role.icon}}">{{getRoleLabel(role.id, \'identifier\')}}</span></div><div class="slds-app-launcher__tile-body slds-scrollable--y"><span class="slds-text-link">{{getRoleLabel(role.id, \'name\')}}</span><p>{{getRoleLabel(role.id, \'description\')}}</p></div></a></li></ul></div></div><hr></ng-container><div class="slds-section slds-is-open"><div class="slds-section__title"><button (click)="toggleShow(\'modules\')" class="slds-button slds-button--icon slds-m-right--small"><system-button-icon [icon]="\'switch\'"></system-button-icon></button><h3>{{language.getLabel(\'LBL_MODULES\')}}</h3></div><div *ngIf="toggleShowModules" class="slds-section__content"><ul class="slds-grid slds-grid--pull-padded slds-wrap"><li *ngFor="let module of getModules()" class="slds-p-horizontal--small slds-size--xx-small" (click)="gotoModule(module)"><a href="javascript:void(0);" class="slds-app-launcher__tile slds-text-link--reset slds-app-launcher__tile--small"><div class="slds-app-launcher__tile-figure slds-app-launcher__tile-figure--small"><system-icon [module]="module" [size]="\'large\'"></system-icon></div><div class="slds-app-launcher__tile-body slds-app-launcher__tile-body--small"><p class="slds-truncate slds-text-link" [title]="language.getModuleName(module)">{{language.getModuleName(module)}}</p></div></a></li></ul></div></div></div></div></div>',host:{class:"slds-context-bar__primary slds-context-bar__item--divider-right"}}),__metadata("design:paramtypes",[services_11.metadata,services_3.language,router_1.Router,services_6.broadcast])],GlobalAppLauncherDialog)}();exports.GlobalAppLauncherDialog=GlobalAppLauncherDialog;var GlobalUser=function(){function e(e,s,t,o,i){var a=this;this.loginService=e,this.router=s,this.elementRef=t,this.renderer=o,this.popup=i,this.hideUserDetails=!0,i.closePopup$.subscribe(function(e){a.hideUserDetails=!0})}return e.prototype.toggleUserDetails=function(){var s=this;this.hideUserDetails=!this.hideUserDetails,this.hideUserDetails?this.clickListener&&this.clickListener():this.clickListener=this.renderer.listenGlobal("document","click",function(e){return s.onClick(e)})},e.prototype.onClick=function(e){this.elementRef.nativeElement.contains(e.target)||(this.hideUserDetails=!0,this.clickListener())},e=__decorate([core_1.Component({selector:"global-user",template:'<ul class="slds-grid slds-grid--vertical-align-center"><li class="slds-dropdown-trigger slds-dropdown-trigger--click slds-m-left--x-small"><button class="slds-button" aria-haspopup="true" (click)="toggleUserDetails()"><span class="slds-icon_container slds-icon-standard-empty slds-icon_container--circle"><system-utility-icon [icon]="\'user\'" [size]="\'x-small\'" [addclasses]="\'slds-icon\'" [colorclass]="\'\'"></system-utility-icon></span></button></li></ul><global-user-panel [hidden]="hideUserDetails"></global-user-panel>',providers:[services_5.popup]}),__metadata("design:paramtypes",[services_1.loginService,router_1.Router,core_1.ElementRef,core_1.Renderer,services_5.popup])],e)}();exports.GlobalUser=GlobalUser;var GlobaUserPanel=function(){function e(e,s,t,o,i,a,l,n,r,d,c){this.rendered=e,this.loginService=s,this.session=t,this.router=o,this.popup=i,this.language=a,this.metadata=l,this.footer=n,this.config=r,this.modalservice=d,this.cookie=c}return e.prototype.logoff=function(){this.loginService.logout()},e.prototype.changeImage=function(){var e=new MouseEvent("click",{bubbles:!0});this.rendered.invokeElementMethod(this.imgupload.element.nativeElement,"dispatchEvent",[e])},e.prototype.getAvialableLanguages=function(){return this.language.getAvialableLanguages(!0)},Object.defineProperty(e.prototype,"displayName",{get:function(){return this.session.authData.display_name?this.session.authData.display_name:this.session.authData.userName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userName",{get:function(){return this.session.authData.userName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentlanguage",{get:function(){return this.language.currentlanguage},set:function(e){this.popup.close(),this.language.currentlanguage=e,this.language.loadLanguage()},enumerable:!0,configurable:!0}),e.prototype.goDetails=function(){this.popup.close(),this.router.navigate(["/module/Users/"+this.session.authData.userId])},e.prototype.changePassword=function(){this.modalservice.openModal("UserChangePasswordModal")},__decorate([core_1.ViewChild("imgupload",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"imgupload",void 0),e=__decorate([core_1.Component({selector:"global-user-panel",template:'<div class="userProfilePanel"><div class="slds-grid slds-p-around--small slds-grid--vertical-align-center"><div><div (click)="changeImage()"><span class="slds-icon_container slds-icon-standard-empty slds-icon_container--circle" style="width:40px;height:40px;"><system-icon [sprite]="\'action\'" [icon]="\'user\'" [size]="\'small\'"></system-icon></span></div><input #imgupload style="display:none" type="file" (change)="uploadImage()"></div><div class="slds-m-left--small"><h1 class="slds-text-heading--medium" [title]="userName">{{displayName}}</h1></div></div><div class="slds-theme--shade slds-p-around--small slds-border--top slds-border--bottom"><ul class="slds-list--horizontal slds-has-dividers--left"><li class="slds-item"><a href="javascript:void(0);" class="slds-text-link--reset" (click)="goDetails()">{{language.getLabel(\'LBL_DETAILS\')}}</a></li><li class="slds-item"><a href="javascript:void(0);" class="slds-text-link--reset" (click)="changePassword()">{{language.getLabel(\'LBL_CHANGE_PASSWORD\')}}</a></li></ul></div><div class="slds-p-around--small slds-form--stacked"><div class="slds-form-element"><label class="slds-form-element__label">{{language.getLabel(\'LBL_SELECT_LANGUAGE\')}}</label><div class="slds-form-element__control"><div class="slds-select_container"><select class="slds-select" [(ngModel)]="currentlanguage"><option *ngFor="let language of getAvialableLanguages()" [value]="language.language">{{language.text}}</option></select></div></div></div></div><div class="slds-theme--shade slds-p-around--x-small slds-grid"><div>{{language.getLabel(\'LBL_LOGGED_ON_SYSTEM\')}}: {{config.data.display}}</div><div class="slds-col--bump-left"><system-utility-icon icon="logout" size="x-small" [title]="language.getLabel(\'LBL_LOGOFF\')" (click)="logoff()"></system-utility-icon></div></div></div>'}),__metadata("design:paramtypes",[core_1.Renderer,services_1.loginService,services_2.session,router_1.Router,services_5.popup,services_3.language,services_11.metadata,services_16.footer,services_4.configurationService,services_18.modal,services_17.cookie])],e)}();exports.GlobaUserPanel=GlobaUserPanel;var GlobalRecentItems=function(){function e(e,s,t,o){this.language=e,this.router=t,this.recent=o,s.setActiveModule("recent",this.language.getLabel("LBL_RECENTLYVIEWED"))}return e.prototype.goRecent=function(e,s){this.router.navigate(["/module/"+e+"/"+s])},e=__decorate([core_1.Component({selector:"global-recent-items",template:'<div class="slds-page-header" role="banner"><div class="slds-grid"><div class="slds-col slds-has-flexi-truncate"><div class="slds-media slds-no-space slds-grow"><div class="slds-media__body"><h1 class="slds-page-header__title slds-m-right--small slds-align-middle slds-truncate">{{language.getLabel(\'LBL_RECENT_ITEMS\')}}</h1><p class="slds-text-title--caps slds-line-height--reset">{{recent.items.length}} {{language.getLabel(\'LBL_ITEMS\')}}</p></div></div></div></div></div><table class="slds-table slds-table--bordered slds-table--fixed-layout" role="grid"><thead><tr class="slds-text-title--caps"><th class="slds-cell-shrink" scope="col"></th><th class="slds-is-sortable slds-is-resizable" scope="col"><a href="javascript:void(0);" class="slds-th__action slds-text-link--reset"><span class="slds-truncate">{{language.getLabel(\'LBL_NAME\')}}</span></a></th><th class="slds-is-sortable slds-is-resizable" scope="col"><a href="javascript:void(0);" class="slds-th__action slds-text-link--reset"><span class="slds-truncate">{{language.getLabel(\'LBL_MODULE\')}}</span></a></th></tr></thead><tbody><tr *ngFor="let recentItem of recent.items" class="slds-hint-parent" (click)="goRecent(recentItem.module_name, recentItem.item_id)"><td role="gridcell" class="slds-cell-shrink"><system-icon [module]="recentItem.module_name" size="small"></system-icon></td><td scope="row"><div class="slds-truncate">{{recentItem.item_summary}}</div></td><td scope="row"><div class="slds-truncate">{{language.getModuleName(recentItem.module_name, true)}}</div></td></tr></tbody></table>'}),__metadata("design:paramtypes",[services_3.language,services_12.navigation,router_1.Router,services_9.recent])],e)}();exports.GlobalRecentItems=GlobalRecentItems;var GlobalSearch=function(){function e(e,s,t,o,i,a){var l=this;this.broadcast=s,this.elementref=t,this.fts=i,this.language=a,this.searchScope="*",e.setActiveModule("search","search: "+i.searchTerm),this.fts.searchByModules(i.searchTerm),this.broadcast.message$.subscribe(function(e){return l.handleMessage(e)})}return e.prototype.getContainerStyle=function(){return{height:"calc(100vh - "+this.elementref.nativeElement.getBoundingClientRect().top+"px)"}},e.prototype.handleMessage=function(e){switch(e.messagetype){case"fts.search":this.doSearch(e.messagedata);break;case"fts.setscope":this.setSearchScope(e.messagedata)}},e.prototype.doSearch=function(e){"*"===this.searchScope?this.fts.searchByModules(e):this.fts.searchByModules(e,[this.searchScope],50)},e.prototype.getScopeClass=function(e){if(e===this.searchScope)return"slds-is-active"},e.prototype.setSearchScope=function(e){e!==this.searchScope&&(this.searchScope=e,this.doSearch(this.fts.searchTerm))},e.prototype.infiniteScroll=function(){return"*"!==this.searchScope},e=__decorate([core_1.Component({selector:"global-search",template:'<div class="spicecrm-globalsearch-container" [ngStyle]="getContainerStyle()"><div class="spicecrm-globalsearch-menu slds-grid slds-grid--vertical slds-navigation-list--vertical slds-navigation-list--vertical-inverse"><h2 class="slds-text-title--caps slds-p-around--medium" id="entity-header">{{language.getLabel(\'LBL_SEARCHRESULTS\')}}</h2><ul><li [ngClass]="getScopeClass(\'*\')"><a href="javascript:void(0);" class="slds-navigation-list--vertical__action slds-text-link--reset" (click)="setSearchScope(\'*\')">{{language.getLabel(\'LBL_TOPRESULTS\')}}</a></li><li *ngFor="let module of fts.searchModules" [ngClass]="getScopeClass(module)"><a href="javascript:void(0);" class="slds-navigation-list--vertical__action slds-text-link--reset" (click)="setSearchScope(module)">{{language.getModuleName(module)}}</a></li></ul></div><div class="spicecrm-globalsearch-results" [ngStyle]="getContainerStyle()"><div *ngIf="fts.runningmodulesearch" class="slds-p-around--medium"><system-spinner></system-spinner></div><div global-search-module class="slds-m-bottom--medium" *ngFor="let result of fts.moduleSearchresults" [module]="result.module" [infinitescroll]="infiniteScroll()"></div></div></div>'}),__metadata("design:paramtypes",[services_12.navigation,services_6.broadcast,core_1.ElementRef,router_1.Router,services_7.fts,services_3.language])],e)}();exports.GlobalSearch=GlobalSearch;var GlobalSearchModule=function(){function e(e,s,t,o,i,a){this.broadcast=e,this.metadata=s,this.elementref=t,this.fts=i,this.language=a,this.module="",this.infinitescroll=!1,this.listfields=[]}return e.prototype.ngOnInit=function(){this.listfields=[];var e=this.metadata.getComponentConfig("GlobalSearchModule",this.module);_.isEmpty(e)&&(e=this.metadata.getModuleDefaultComponentConfigByUsage(this.module,"list"));for(var s=0,t=this.metadata.getFieldSetFields(e.fieldset);s<t.length;s++){var o=t[s];!1!==o.fieldconfig.default&&this.listfields.push(o)}},e.prototype.getCount=function(){var s=this,t={};return this.fts.moduleSearchresults.some(function(e){if(e.module===s.module)return t={total:e.data.total,hits:e.data.hits.length},!0}),t},e.prototype.getDisplay=function(){return!this.fts.runningmodulesearch&&0<this.getCount().total?"inherit":"none"},e.prototype.canViewMore=function(){return!this.infinitescroll&&5<this.getCount().total},e.prototype.getItems=function(){var s=this,t=[];return this.fts.moduleSearchresults.some(function(e){if(e.module===s.module)return t=e.data.hits,!0}),t},e.prototype.getContainerStyle=function(){return this.infinitescroll?{"max-height":"calc(100vh - "+this.tablecontent.element.nativeElement.getBoundingClientRect().top+"px)","overflow-y":"scroll","margin-top":"-1px"}:{}},e.prototype.setSearchScope=function(){this.broadcast.broadcastMessage("fts.setscope",this.module)},e.prototype.onScroll=function(e){if(this.infinitescroll){var s=this.tablecontent.element.nativeElement;s.scrollTop+s.clientHeight+50>s.scrollHeight&&this.fts.loadMore()}},__decorate([core_1.ViewChild("tablecontent",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],e.prototype,"tablecontent",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"module",void 0),__decorate([core_1.Input(),__metadata("design:type",Boolean)],e.prototype,"infinitescroll",void 0),e=__decorate([core_1.Component({selector:"[global-search-module]",template:'<div class="slds-page-header"><div class="slds-grid"><div class="slds-col slds-has-flexi-truncate"><h1 class="slds-page-header__title slds-truncate">{{language.getModuleName(module)}}</h1></div></div><div class="slds-grid"><div class="slds-col slds-align-bottom"><ul class="slds-list--horizontal slds-has-dividers--left"><li class="slds-item">{{getCount().hits}} {{language.getLabel(\'LBL_OF\')}} {{getCount().total}} {{language.getLabel(\'LBL_ITEMS\')}}</li><li *ngIf="canViewMore()" class="slds-item slds-text-link--reset" (click)="setSearchScope()">{{language.getLabel(\'LBL_VIEWALL\')}}</li></ul></div></div></div><div><table style="margin-bottom: 0px;" class="slds-table slds-table--bordered slds-table--fixed-layout" role="grid"><thead><tr class="slds-text-title--caps"><th *ngFor="let item of listfields" scope="col"><div class="slds-truncate slds-p-around--x-small">{{language.getFieldDisplayName(module, item.field)}}</div></th></tr></thead></table><div #tablecontent class="slds-scrollable--y" [ngStyle]="getContainerStyle()" (scroll)="onScroll($event)"><table class="slds-table slds-table--bordered slds-table--fixed-layout" role="grid"><tbody><tr global-search-module-item *ngFor="let item of getItems()" [module]="module" [listfields]="listfields" [listitem]="item"></tr></tbody></table><system-spinner *ngIf="fts.runningmodulesearch"></system-spinner></div></div>',host:{"[style.display]":"getDisplay()"}}),__metadata("design:paramtypes",[services_6.broadcast,services_11.metadata,core_1.ElementRef,router_1.Router,services_7.fts,services_3.language])],e)}();exports.GlobalSearchModule=GlobalSearchModule;var GlobalSearchModuleItem=function(){function e(e,s,t,o){this.elementref=e,this.router=s,this.view=t,this.model=o,this.module="",this.listfields="",this.listitem={},this.view.isEditable=!1}return e.prototype.ngOnInit=function(){this.model.module=this.listitem._type,this.model.id=this.listitem._id,this.model.data=this.listitem._source},e.prototype.navigateDetail=function(){this.router.navigate(["/module/"+this.model.module+"/"+this.model.id])},__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"module",void 0),__decorate([core_1.Input(),__metadata("design:type",String)],e.prototype,"listfields",void 0),__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"listitem",void 0),e=__decorate([core_1.Component({selector:"[global-search-module-item]",template:'<td *ngFor="let item of listfields" scope="row" (click)="navigateDetail()"><field-container [field]="item.field" [fieldconfig]="item.fieldconfig" [fielddisplayclass]="\'slds-truncate\'"></field-container></td>',providers:[services_14.view,services_8.model]}),__metadata("design:paramtypes",[core_1.ElementRef,router_1.Router,services_14.view,services_8.model])],e)}();exports.GlobalSearchModuleItem=GlobalSearchModuleItem;var GlobalNewsFeed=function(){function e(e){var s=this;this.http=e,this.news=[],this.isLoading=!0;var t=btoa("http://www.spicecrm.io/wp-json/wp/v2/posts");this.http.get("proxy/?useurl="+t).subscribe(function(e){s.news=e,s.isLoading=!1})}return e.prototype.getContainerClass=function(){return this.isLoading?"slds-align--absolute-center":""},e=__decorate([core_1.Component({selector:"global-newsfeed",template:'<div style="height: 100%;" class="slds-p-around--medium" [ngClass]="getContainerClass()"><system-spinner *ngIf="isLoading"></system-spinner><global-newsfeed-item *ngFor="let newsitem of news" [item]="newsitem"></global-newsfeed-item></div>'}),__metadata("design:paramtypes",[http_1.HttpClient])],e)}();exports.GlobalNewsFeed=GlobalNewsFeed;var GlobalNewsFeedItem=function(){function e(e){this.http=e,this.item={}}return e.prototype.getDate=function(){return moment(this.item.date).fromNow()},e.prototype.getExcerpt=function(){return this.item.excerpt.rendered.replace("<a",'<a target="_blank"')},__decorate([core_1.Input(),__metadata("design:type",Object)],e.prototype,"item",void 0),e=__decorate([core_1.Component({selector:"global-newsfeed-item",template:'<article class="slds-card slds-m-bottom--medium"><div class="slds-card__header slds-grid"><header class="spicecrm-newsfeed-item-header slds-media slds-media--center slds-has-flexi-truncate"><div class="slds-media__body slds-truncate"><h2><a target="_blank" [attr.href]="item.link">{{item.title.rendered}}</a></h2></div></header></div><div class="slds-card__body"><div class="slds-card__body--inner slds-grid slds-wrap slds-grid--pull-padded" [innerHTML]="getExcerpt()"></div></div><div class="slds-card__footer">{{getDate()}}</div></article>'}),__metadata("design:paramtypes",[http_1.HttpClient])],e)}();exports.GlobalNewsFeedItem=GlobalNewsFeedItem;var services_19=require("../services/services"),GlobalLoginGoogle=function(){function e(e,s,t){var o=this;this.loginService=e,this.configuration=s,this.session=t,this.clientId="",this.visible=!1,this.scope=["profile","email","https://www.googleapis.com/auth/plus.me","https://www.googleapis.com/auth/contacts.readonly","https://www.googleapis.com/auth/admin.directory.user.readonly","https://www.googleapis.com/auth/calendar","https://www.googleapis.com/auth/tasks"].join(" "),this.configuration.loaded$.subscribe(function(e){o.googleInit()})}return e.prototype.googleInit=function(){var s=this;this.configuration.data.backendextensions.hasOwnProperty("google_oauth")&&null!=this.configuration.data.backendextensions.google_oauth.config&&gapi.load("auth2",function(){var e=JSON.parse(s.configuration.data.backendextensions.google_oauth.config.calendarconfig);s.clientId=e.web.client_id,s.auth2=gapi.auth2.init({client_id:s.clientId,cookiepolicy:"single_host_origin",scope:s.scope}),s.visible=!0})},e.prototype.signInClick=function(){var o=this;Promise.resolve(this.auth2.signIn()).then(function(e){var s=e.getAuthResponse().id_token,t=e.getAuthResponse().access_token;o.loginService.oauthToken=s,o.loginService.accessToken=t,o.loginService.login()}).catch(function(e){console.log(JSON.stringify(e,void 0,2))})},e=__decorate([core_1.Component({selector:"global-login-google",template:'<button class="slds-button slds-button_neutral slds-m-vertical--x-small" (click)="signInClick()" style="width:100%" *ngIf="visible"><div class="slds-align--absolute-center slds-grid slds-grid--vertical-align-center"><img style="height: 18px;width:18px;margin-right: 24px;" src="https://developers.google.com/identity/images/g-logo.png"><div>Sign in with Google</div></div></button>'}),__metadata("design:paramtypes",[services_1.loginService,services_4.configurationService,services_2.session])],e)}();exports.GlobalLoginGoogle=GlobalLoginGoogle;var GlobalComponents=function(){function GlobalComponents(e,s){this.metadata=e,this.vms=s,this.version="1.0",this.build_date="2018-10-22",this.vms.registerModule(this)}return GlobalComponents=__decorate([core_1.NgModule({imports:[common_1.CommonModule,forms_1.FormsModule,objectfields_1.ObjectFields,systemcomponents_1.SystemComponents,router_1.RouterModule.forRoot([{path:"login",component:GlobalLogin},{path:"setup",component:GlobalSetup},{path:"recent",component:GlobalRecentItems,canActivate:[services_1.loginCheck]},{path:"search",component:GlobalSearch,canActivate:[services_1.loginCheck]}])],declarations:[GlobalNewsFeed,GlobalNewsFeedItem,GlobalHeader,GlobalHeaderTop,GlobalHeaderSearch,GlobalHeaderSearchResultsItems,GlobalHeaderSearchResultsItem,GlobalHeaderSearchRecentItems,GlobalHeaderSearchRecentItem,GlobalHeaderTools,GlobalHeaderActions,GlobalHeaderActionItem,GlobalHeaderFavorite,GlobalHeaderWorkbench,GlobalFooter,GlobalNavigation,GlobalNavigationMenu,GlobalNavigationMenuItem,GlobalNavigationMenuItemNew,GlobalNavigationMenuItemRoute,GlobalNavigationMenuItemIcon,GlobalNavigationMenuMore,GlobalLogin,GlobalSetup,GlobalLoginForgotPassword,GlobalLoginResetPassword,GlobalUser,GlobaUserPanel,GlobalAppLauncher,GlobalAppLauncherDialog,GlobalDockedComposerContainer,GlobalDockedComposer,GlobalDockedComposerModal,GlobalDockedComposerOverflow,GlobalComposeButton,GlobalRecentItems,GlobalSearch,GlobalSearchModule,GlobalSearchModuleItem,GlobalLoginGoogle],entryComponents:[GlobalHeader,GlobalNavigationMenuItem,GlobalNavigationMenuItemNew,GlobalNavigationMenuMore,GlobalHeaderTop,GlobalHeaderSearch,GlobalHeaderSearchResultsItems,GlobalHeaderSearchResultsItem,GlobalHeaderSearchRecentItems,GlobalHeaderSearchRecentItem,GlobalDockedComposerContainer,GlobalDockedComposer,GlobalDockedComposerContainer],exports:[GlobalNewsFeed,GlobalHeader,GlobalFooter,GlobalDockedComposerContainer,GlobalDockedComposer,GlobalDockedComposerOverflow,GlobalComposeButton]}),__metadata("design:paramtypes",[services_11.metadata,services_19.VersionManagerService])],GlobalComponents)}();exports.GlobalComponents=GlobalComponents;